[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Guía para la implementación de diseños experimentales en la industria farmacéutica",
    "section": "",
    "text": "Portada\nPrueba\n\n\n\n\n Volver arriba",
    "crumbs": [
      "Portada"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "",
    "text": "2 Metodología",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#evaluación-de-la-significancia-de-los-efectos",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#evaluación-de-la-significancia-de-los-efectos",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "2.1 Evaluación de la significancia de los efectos",
    "text": "2.1 Evaluación de la significancia de los efectos\nEl presente estudio tiene como propósito analizar el impacto de eliminar réplicas o los puntos centrales en un diseño factorial completo \\(2^k\\) sobre la significancia estadística de los efectos principales e interacciones, así como sobre el error cuadrático medio (ECM). Para este fin se realizaron 1000 simulaciones independientes, y en cada simulación se generó un caso particular de efectos activos y su correspondiente respuesta.\nEn cada simulación se genera un vector con todos los factores y sus interacciones del respectivo diseño factorial completo \\(2^k\\) los cuales se agrupan en el vector todos_efectos, así:\n\n\n\n\n\n\n\n\nDiseño factorial\nNúmero de efectos\nEfectos\n\n\n\n\n\\(2^2\\)\n3\nA, B, AB\n\n\n\\(2^3\\)\n7\nA, B, C, AB, AC, BC, ABC\n\n\n\\(2^4\\)\n15\nA, B, C, D, AB, AC, AD, BC, BD, CD, ABC, ABD, ACD, BCD, ABCD\n\n\n\\(2^5\\)\n31\nA, B, C, D, E, AB, AC, AD, AE, BC, BD, BE, CD, CE, DE, ABC, ABD, ABE, ACD, ACE, ADE, BCD, BCE, BDE, CDE, ABCD, ABCE, ABDE, ACDE, BCDE, ABCDE\n\n\n\nA partir de este conjunto, se selecciona aleatoriamente un número aleatorio de efectos que serán considerados significativos; dichos efectos se denominan efectos activos. A estos efectos se les asigna un valor aleatorio tomado de una distribución uniforme en el intervalo \\([−7,-0.5]\\) y \\([0.5, 7]\\), mientras que los demás mantienen valor cero. De esta forma se construye el vector efectos_reales_vec, que refleja cuáles efectos son diferentes de cero. Posteriormente, la información se almacena en la tabla efectos_reales, que guarda en forma binaria (1/0) cuáles factores fueron definidos como significativos.\nSe genera un diseño factorial \\(2^k\\) con dos réplicas y cinco puntos centrales (dis1_cod). A este diseño se le asigna una respuesta (yrta) calculada en función de los efectos previamente definidos, es decir, se multiplican los valores de los factores y sus interacciones por los coeficientes correspondientes en efectos_reales_vec, más un término de error aleatorio error con distribución normal \\((\\mu = 0, \\sigma^2 = 2^2)\\). Como resultado, los factores seleccionados como activos aportan un efecto distinto de cero, mientras que los demás se anulan. La respuesta final se obtiene sumando estos efectos y el error a una constante de 50.\nEste diseño inicial se emplea para construir otras tres variantes eliminando, de manera aleatoria, filas correspondientes a réplicas o puntos centrales: un diseño con réplicas pero sin puntos centrales (dis2_cod), un diseño sin réplicas y con cinco puntos centrales (dis3_cod) y un diseño sin réplicas con dos puntos centrales (dis4_cod)\nPara cada diseño se ajusta el modelo completo (mod1 &lt;- lm(yrta~A*B, data=dis1_cod)), considerando tanto los efectos principales como las interacciones, y se calcula el ANOVA correspondiente:\nDiseño factorial completo \\(2^2\\):\n\\[\nY \\;=\\; \\beta_0 \\;+\\; \\beta_1 X_1 \\;+\\; \\beta_2 X_2 \\;+\\; \\beta_{12}X_1X_2 \\;+\\; \\varepsilon,\n\\quad \\varepsilon \\sim \\mathcal{N}(\\mu = 0, \\sigma^2 = 2^2)\n\\]\nDiseño factorial completo \\(2^3\\):\n\\[\nY = \\beta_0\n+ \\sum_{i=1}^{3} \\beta_i X_i\n+ \\sum_{i&lt;j}^{3} \\beta_{ij} X_i X_j\n+ \\beta_{123} X_1 X_2 X_3\n+ \\varepsilon,\n\\quad i = 1,2,3;\\;\\; j = 1,2,3;\n\\quad \\varepsilon  \\sim  N(\\mu = 0, \\sigma^2 = 2^2)\n\\]\nDiseño factorial completo \\(2^4\\):\n\\[\nY = \\beta_0\n+ \\sum_{i=1}^{4} \\beta_i X_i\n+ \\sum_{i&lt;j}^{4} \\beta_{ij} X_i X_j\n+ \\sum_{i&lt;j&lt;k}^{4} \\beta_{ijk} X_i X_j X_k\n+ \\beta_{1234}\\, X_1 X_2 X_3 X_4\n+ \\varepsilon\n\\]\ndonde,\n\\[\ni,j,k \\in \\{1,2,3,4\\},\\;\\; \\varepsilon \\sim \\mathcal{N}(\\mu = 0, \\sigma^2 = 2^2)\n\\]\nDiseño factorial completo \\(2^5\\):\n\\[\nY = \\beta_0\n+ \\sum_{i=1}^{5} \\beta_i X_i\n+ \\sum_{i&lt;j}^{5} \\beta_{ij} X_i X_j\n+ \\sum_{i&lt;j&lt;k}^{5} \\beta_{ijk} X_i X_j X_k\n+ \\sum_{i&lt;j&lt;k&lt;l}^{5} \\beta_{ijkl} X_i X_j X_k X_l\n+ \\beta_{12345}\\, X_1 X_2 X_3 X_4 X_5\n+ \\varepsilon\n\\]\ndonde,\n\\[\ni,j,k,l \\in \\{1,2,3,4,5\\},\\;\\; \\varepsilon \\sim \\mathcal{N}(\\mu = 0, \\sigma^2 = 2^2)\n\\]\nCon los resultados de significancia de los efectos se almacenan en las tablas TAB1_22, TAB2_22y TAB3_22, donde el valor 1 indica significancia estadística (\\(p &lt; 0.05\\)) y 0 indica no significancia. Este procedimiento se implementa evaluando, en cada fila del ANOVA, si el valor \\(p\\) es menor o igual a 0.05, transformando el resultado lógico en un valor entero.\nA partir de estas tablas se calcula el porcentaje de concordancia entre los efectos reales y los detectados por cada modelo, la potencia (proporción de efectos verdaderamente significativos correctamente identificados) y el error tipo I (proporción de efectos nulos detectados como significativos).",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#evaluación-del-ecm-con-medidas-repetidas",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#evaluación-del-ecm-con-medidas-repetidas",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "2.2 Evaluación del ECM con medidas repetidas",
    "text": "2.2 Evaluación del ECM con medidas repetidas\nCon relación a la evaluación del ECM, se utiliza la metodología de medidas repetidas, en la cual a una misma unidad experimental se le aplican sucesivamente varios tratamientos, generando valores repetidos de la respuesta sobre el mismo individuo (Dı́az Monroy y Mario Alfonso (2012)).\nEn este estudio, a partir de los diseños simulados en la sección anterior, cada fila corresponde a la simulación del diseño experimental de referencia (dis1_cod), al que se le generan variantes al eliminar réplicas o puntos centrales (dis2_cod, dis3_cod, dis4_cod). Para cada diseño se obtiene como variable respuesta el Error Cuadrático Medio (ECM), calculado mediante la siguiente fórmula:\n\\[\n\\text{ECM} = \\frac{\\text{deviance}(modelo)}{\\text{grados de libertad del residual}(modelo)}.\n\\]\nEstos resultados fueron compilados en la matriz ECM_tab_22, que corresponde a la matriz \\(X = (x_{ij})\\), donde \\(x_{ij}\\) representa la respuesta del \\(i\\)-ésimo sujeto al \\(j\\)-ésimo tratamiento. Incialmente, se realiza un análisis descriptivo de los ECM (Ver Figura 4.2). Luego, se construye la matriz de contrastes \\(C\\), donde cada fila representa una hipótesis a evaluar. En este caso, se plantea la utilización de una matriz de contrastes \\(C_1\\) cuyo objetivo es contrastar simultáneamente todas las medias de los tratamientos. Con ello, se busca determinar si existe al menos un tratamiento que difiera significativamente de los demás, lo que constituye el análogo a la prueba ANOVA clásica, pero en un contexto donde los tratamientos son dependientes.\n\\[\nC_1 =\n\\begin{bmatrix}\n-1 & -1 &  0 &  0 \\\\\n0 & -1 &  1 &  0 \\\\\n0 &  0 & -1 &  1\n\\end{bmatrix}\n\\]\nAsimismo, es posible considerar una matriz de contrastes generales de interés \\(C_2\\), tales como:\n\\[\nC_2 =\n\\begin{bmatrix}\n-1 & -1 &  1 &  1 \\\\\n-1 &  1 &  1 &  1 \\\\\n1 & -1 &  0 &  0\n\\end{bmatrix}\n\\]\nDonde los contrastes a evaluar son:\nContraste 1: Contraste que relaciona los diseños con réplica con respecto a los diseños sin réplica \\(C_1 =\\) (-1, -1, 1, 1)\nContraste 2: Contraste que relaciona el diseño con réplica y 5 puntos centrales frente al conjunto de variantes derivadas del mismo \\(C_2 =\\) (-1, 1, 1, 1)\nContraste 3: Contraste que relaciona el impacto de la réplica en diseños con la misma cantidad de puntos centrales \\(C_3 =\\) (1, -1, 0, 0)\nLa matriz \\(C\\) se utiliza para transformar los datos: \\(Y = CX\\). De esta forma, el problema se reduce a \\((p-1)\\) dimensiones y se trabaja con contrastes independientes, evitando dependencia entre medias y permitiendo aplicar la prueba \\(T^2\\) de Hotelling.\nEl cálculo implementado en el código sigue la formulación teórica:\n\\[\nT^2 = n(C \\overline{X})' (CSC')^{-1} (C \\overline{X}),\n\\]\ndonde \\(n\\) es el número de simulaciones y \\(S\\) la matriz de covarianzas estimada mediante\n\\[\nS = \\frac{1}{n-1}X'(I - \\tfrac{1}{n}\\mathbf{1}\\mathbf{1}')X.\n\\]\nLa decisión es rechazar \\(H_0\\) si, para un nivel de significancia \\(\\alpha = 0.05\\),\n\\[\nF = \\frac{n - p + 1}{(n-1)(p-1)} T^2 &gt; F_{(\\alpha, p-1, n-p+1)}\n\\]",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-factorial-completo-22",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-factorial-completo-22",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "3.1 Diseño factorial completo \\(2^2\\)",
    "text": "3.1 Diseño factorial completo \\(2^2\\)\n\n3.1.1 Significancia de los efectos\n\n\nCódigo\n# Matrices\nTAB1_22 &lt;- matrix(0, nrow = n, ncol = 3)\nTAB2_22 &lt;- matrix(0, nrow = n, ncol = 3)\nTAB3_22 &lt;- matrix(0, nrow = n, ncol = 3)\nTAB4_22 &lt;- matrix(0, nrow = n, ncol = 3)\nTAB6_22 &lt;- matrix(0, nrow = n, ncol = 3)\nefectos_reales_22 &lt;- matrix(NA, nrow = n, ncol = 3)\n\nnames_22 &lt;- c(\"A\",\"B\", \"A:B\")\ncolnames(TAB1_22) &lt;- names_22\ncolnames(TAB2_22) &lt;- names_22\ncolnames(TAB3_22) &lt;- names_22\ncolnames(TAB4_22) &lt;- names_22\ncolnames(TAB6_22) &lt;- names_22\ncolnames(efectos_reales_22) &lt;- names_22\n\n# Tabla para completar los errores\nECM_tab_22 &lt;- data.frame(       \n    dis1_22 = numeric(n),\n    dis2_22 = numeric(n),\n    dis3_22 = numeric(n),\n    dis4_22 = numeric(n))\n\n# Bucle principal\nset.seed(3)\nfor(i in seq_len(n)){\n  ## Efectos a evaluar en el este diseño\n  todos_efectos_22 &lt;- c(\"A\", \"B\", \"A:B\")\n  \n  # Selección de un número aleatorio entre 1 y 3\n  # dado que existen 3 efectos posibles a evaluar en este diseño.\n  n_ef &lt;- sample(0:length(todos_efectos_22), 1)\n  \n  # Elección aleatoria _n_ef_ efectos que serán los efectos significativos\n  efectos_activos &lt;- sample(todos_efectos_22, n_ef)\n  efectos_reales_22_vec &lt;- setNames(rep(0, length(todos_efectos_22)), todos_efectos_22)\n  \n  # Asignación de un valor aleatorio a los efectos elegidos como significativos:\n  efectos_reales_22_vec[efectos_activos] &lt;- sample(c(runif(n_ef, -7, -0.5), \n                                                  runif(n_ef,  0.5, 7)),n_ef)\n  \n  # Guardar efectos reales como 1/0\n  efectos_reales_22[i,] &lt;- c(\n    as.integer(efectos_reales_22_vec[\"A\"]   != 0),\n    as.integer(efectos_reales_22_vec[\"B\"]   != 0),\n    as.integer(efectos_reales_22_vec[\"A:B\"]  != 0))\n  \n  # Generar respuesta\n  \n  ## Diseño con réplicas y con 5 puntos centrales\n \n  dis1_cod &lt;- data.frame(\n    A = c(rep(c(-1,1),2), rep(c(-1,1),2), rep(0,5)),\n    B = c(rep(c(rep(-1,2), rep(1,2)), 2), rep(0,5)))\n \n  n_corridas &lt;- nrow(dis1_cod)\n  \n  ## Generación del error\n  error &lt;- rnorm(n_corridas, 0, 2)               #error ~ (mu = 0, sigma^2 = 2^2)\n  \n  ## Generación de la respuesta\n  yrta &lt;- 50 +\n    efectos_reales_22_vec[\"A\"]   * dis1_cod$A +\n    efectos_reales_22_vec[\"B\"]   * dis1_cod$B +\n    efectos_reales_22_vec[\"A:B\"]  * dis1_cod$A * dis1_cod$B +\n    error\n  \n  ## Asignación de la respuesta al dis1_cod\n  dis1_cod &lt;- cbind(dis1_cod, yrta)\n \n  ## Diseño con réplicas y sin puntos centrales\n  \n  dis2_cod &lt;- dis1_cod[-c(9:13),]\n  \n  ## Diseño sin réplica y con cinco puntos centrales\n  rep1 &lt;- c(1:4)\n  rep2 &lt;- c(5:8)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis3_cod &lt;- dis1_cod[-sel,]      \n  \n  ## Diseño sin réplica y con dos puntos centrales\n  rep1 &lt;- c(1:4)\n  rep2 &lt;- c(5:8)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  rep_pc &lt;- sample(c(9:13),3)                    #punto central a eliminar\n  \n  dis4_cod &lt;- dis1_cod[-c(sel,rep_pc),]     \n  \n  ## Diseño sin réplica y sin puntos centrales\n  rep1 &lt;- c(1:4, 9:13)\n  rep2 &lt;- c(5:8, 9:13)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis6_cod &lt;- dis1_cod[-sel,] \n  \n  mod6 &lt;- lm(yrta~A*B, data=dis6_cod)\n  \n  graf &lt;- suppressMessages(halfnormal(mod6, alpha = 0.05, plot=FALSE, method=\"Lenth\"))\n  signif &lt;- graf$signif\n  TAB6_22[i, todos_efectos_22 %in% signif] &lt;- 1\n  \n  # Modelo\n  ## Evaluación del diseño con réplicas y con cinco puntos centrales\n  mod1 &lt;- lm(yrta~A*B, data=dis1_cod) \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  mod2 &lt;- lm(yrta~A*B, data=dis2_cod)  \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  mod3 &lt;- lm(yrta~A*B, data=dis3_cod)  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  mod4 &lt;- lm(yrta~A*B, data=dis4_cod)  \n \n  ## Almacenar los ECM\n  ECM_tab_22$dis1_22[i] &lt;- (deviance(mod1) / df.residual(mod1))\n  ECM_tab_22$dis2_22[i] &lt;- (deviance(mod2) / df.residual(mod2))\n  ECM_tab_22$dis3_22[i] &lt;- (deviance(mod3) / df.residual(mod3))\n  ECM_tab_22$dis4_22[i] &lt;- (deviance(mod4) / df.residual(mod4))\n  \n  # Lista de modelos y de tablas\n  mods &lt;- list(mod1, mod2, mod3, mod4)\n  tabs &lt;- list(TAB1_22, TAB2_22, TAB3_22, TAB4_22)\n\n  for (j in seq_along(mods)) {\n    tabs[[j]][i, ] &lt;- sapply(1:3, function(k) {\n    as.integer(anova(mods[[j]])[k, 5] &lt;= 0.05) })}\n  \n  ## Evaluación del diseño con réplicas y con cinco puntos centrales\n  TAB1_22 &lt;- tabs[[1]] \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  TAB2_22 &lt;- tabs[[2]] \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  TAB3_22 &lt;- tabs[[3]]  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  TAB4_22 &lt;- tabs[[4]]}  \n\n\n\n\n3.1.2 Potencia y error tipo I\n\n\nCódigo\n## Evaluación del diseño con réplicas y con cinco puntos centrales\ncomp1_22 &lt;- round(colSums(efectos_reales_22 == TAB1_22) / n * 100, 2)\npot1_22 &lt;- round(colSums((efectos_reales_22 == 1) & (TAB1_22 == 1)) /\n                colSums(efectos_reales_22 == 1) * 100, 2)\nerr1_22 &lt;- round(colSums((efectos_reales_22 == 0) & (TAB1_22 == 1)) /\n                colSums(efectos_reales_22 == 0) * 100, 2)\n\n## Evaluación del diseño con réplicas y sin puntos centrales\ncomp2_22 &lt;- round(colSums(efectos_reales_22 == TAB2_22) / n * 100, 2)\npot2_22 &lt;- round(colSums((efectos_reales_22 == 1) & (TAB2_22 == 1)) / \n                colSums(efectos_reales_22 == 1) * 100, 2)\nerr2_22 &lt;- round(colSums((efectos_reales_22 == 0) & (TAB2_22 == 1)) / \n                colSums(efectos_reales_22 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con cinco puntos centrales\ncomp3_22 &lt;- round(colSums(efectos_reales_22 == TAB3_22) / n * 100, 2)\npot3_22 &lt;- round(colSums((efectos_reales_22 == 1) & (TAB3_22 == 1)) / \n                colSums(efectos_reales_22 == 1) * 100, 2)\nerr3_22 &lt;- round(colSums((efectos_reales_22 == 0) & (TAB3_22 == 1)) / \n                colSums(efectos_reales_22 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con dos puntos centrales\ncomp4_22 &lt;- round(colSums(efectos_reales_22 == TAB4_22) / n * 100, 2)\npot4_22 &lt;- round(colSums((efectos_reales_22 == 1) & (TAB4_22 == 1)) / \n                colSums(efectos_reales_22 == 1) * 100, 2)\nerr4_22 &lt;- round(colSums((efectos_reales_22 == 0) & (TAB4_22 == 1)) / \n                colSums(efectos_reales_22 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplica y sin puntos centrales\ncomp6_22 &lt;- round(colSums(efectos_reales_22 == TAB6_22) / n * 100, 2)\npot6_22 &lt;- round(colSums((efectos_reales_22 == 1) & (TAB6_22 == 1)) /\n                colSums(efectos_reales_22 == 1) * 100, 2)\nerr6_22 &lt;- round(colSums((efectos_reales_22 == 0) & (TAB6_22 == 1)) /\n                colSums(efectos_reales_22 == 0) * 100, 2)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-factorial-completo-23",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-factorial-completo-23",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "3.2 Diseño factorial completo \\(2^3\\)",
    "text": "3.2 Diseño factorial completo \\(2^3\\)\n\n3.2.1 Significancia de los efectos\n\n\nCódigo\n# Matrices\nTAB1_23 &lt;- matrix(0, nrow = n, ncol = 7)\nTAB2_23 &lt;- matrix(0, nrow = n, ncol = 7)\nTAB3_23 &lt;- matrix(0, nrow = n, ncol = 7)\nTAB4_23 &lt;- matrix(0, nrow = n, ncol = 7)\nTAB6_23 &lt;- matrix(0, nrow = n, ncol = 7)\nefectos_reales_23 &lt;- matrix(0, nrow = n, ncol = 7)\n\nnames_23 &lt;- c(\"A\",\"B\",\"C\",\"A:B\",\"A:C\",\"B:C\",\"A:B:C\")\ncolnames(TAB1_23) &lt;- names_23\ncolnames(TAB2_23) &lt;- names_23\ncolnames(TAB3_23) &lt;- names_23\ncolnames(TAB4_23) &lt;- names_23\ncolnames(TAB6_23) &lt;- names_23\ncolnames(efectos_reales_23) &lt;- names_23\n\n# Tabla para completar los errores\nECM_tab_23 &lt;- data.frame(       \n    dis1_23 = numeric(n),\n    dis2_23 = numeric(n),\n    dis3_23 = numeric(n),\n    dis4_23 = numeric(n))\n\n# Bucle principal\nset.seed(3)\nfor(i in seq_len(n)){\n  ## Efectos a evaluar en el este diseño\n  todos_efectos_23 &lt;- c(\"A\",\"B\",\"C\",\"A:B\",\"A:C\",\"B:C\",\"A:B:C\")\n  \n  # Selección de un número aleatorio entre 1 y 7\n  # dado que existen 7 efectos posibles a evaluar en este diseño.\n  n_ef &lt;- sample(0:length(todos_efectos_23), 1)\n  \n  # Elección aleatoria _n_ef_ efectos que serán los efectos significativos\n  efectos_activos &lt;- sample(todos_efectos_23, n_ef)\n  efectos_reales_23_vec &lt;- setNames(rep(0, length(todos_efectos_23)), todos_efectos_23)\n  \n  # Asignación de un valor aleatorio a los efectos elegidos como significativos:\n  efectos_reales_23_vec[efectos_activos] &lt;- sample(c(runif(n_ef, -7, -0.5), \n                                                  runif(n_ef,  0.5, 7)),n_ef)\n  \n  # Guardar efectos reales como 1/0\n  efectos_reales_23[i,] &lt;- c(\n    as.integer(efectos_reales_23_vec[\"A\"]     != 0),\n    as.integer(efectos_reales_23_vec[\"B\"]     != 0),\n    as.integer(efectos_reales_23_vec[\"C\"]     != 0),\n    as.integer(efectos_reales_23_vec[\"A:B\"]   != 0),\n    as.integer(efectos_reales_23_vec[\"A:C\"]   != 0),\n    as.integer(efectos_reales_23_vec[\"B:C\"]   != 0),\n    as.integer(efectos_reales_23_vec[\"A:B:C\"] != 0))\n  \n  # Generar respuesta\n  \n  ## Diseño de variables codificadas con réplicas y con 5 puntos centrales\n \n  dis1_cod &lt;- data.frame(\n    A = c(rep(c(-1,1),4), rep(c(-1,1),4), rep(0,5)),\n    B = c(rep(c(rep(-1,2), rep(1,2)), 4), rep(0,5)),\n    C = c(rep(-1,4), rep(1,4), rep(-1,4), rep(1,4), rep(0,5)))\n \n  n_corridas &lt;- nrow(dis1_cod)\n  \n  ## Generación del error\n  error &lt;- rnorm(n_corridas, 0, 2)       #error ~ (mu = 0, sigma^2 = 2^2)\n  \n  ## Generación de la respuesta\n  yrta &lt;- 50 +\n    efectos_reales_23_vec[\"A\"]     * dis1_cod$A +\n    efectos_reales_23_vec[\"B\"]     * dis1_cod$B +\n    efectos_reales_23_vec[\"C\"]     * dis1_cod$C +\n    efectos_reales_23_vec[\"A:B\"]   * dis1_cod$A * dis1_cod$B +\n    efectos_reales_23_vec[\"A:C\"]   * dis1_cod$A * dis1_cod$C +\n    efectos_reales_23_vec[\"B:C\"]   * dis1_cod$B * dis1_cod$C +\n    efectos_reales_23_vec[\"A:B:C\"] * dis1_cod$A * dis1_cod$B * dis1_cod$C +\n    error\n  \n  ## Asignación de la respuesta al dis1_cod\n  dis1_cod &lt;- cbind(dis1_cod, yrta)\n \n  ## Diseño con réplicas y sin puntos centrales\n  \n  dis2_cod &lt;- dis1_cod[-c(17:21),]\n  \n  ## Diseño sin réplica y con cinco puntos centrales\n  rep1 &lt;- c(1:8)\n  rep2 &lt;- c(9:16)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis3_cod &lt;- dis1_cod[-sel,]      \n  \n  ## Diseño sin réplica y con dos puntos centrales\n  rep1 &lt;- c(1:8)\n  rep2 &lt;- c(9:16)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  rep_pc &lt;- sample(c(17:21),3)                   #punto central a eliminar\n  \n  dis4_cod &lt;- dis1_cod[-c(sel,rep_pc),]     \n  \n  ## Diseño sin réplica y sin puntos centrales\n  rep1 &lt;- c(1:8, 17:21)\n  rep2 &lt;- c(9:16, 17:21)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis6_cod &lt;- dis1_cod[-sel,] \n  \n  mod6 &lt;- lm(yrta~A*B*C, data=dis6_cod)\n  \n  graf &lt;- suppressMessages(halfnormal(mod6, alpha = 0.05, plot=FALSE, method=\"Lenth\"))\n  signif &lt;- graf$signif\n  TAB6_23[i, todos_efectos_23 %in% signif] &lt;- 1\n\n  # Modelo\n  ## Evaluación del diseño con réplicas y con cinco puntos centrales\n  mod1 &lt;- lm(yrta~A*B*C, data=dis1_cod)  \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  mod2 &lt;- lm(yrta~A*B*C, data=dis2_cod)  \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  mod3 &lt;- lm(yrta~A*B*C, data=dis3_cod)  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  mod4 &lt;- lm(yrta~A*B*C, data=dis4_cod)  \n \n  ## Almacenar los ECM\n  ECM_tab_23$dis1_23[i] &lt;- (deviance(mod1) / df.residual(mod1))\n  ECM_tab_23$dis2_23[i] &lt;- (deviance(mod2) / df.residual(mod2))\n  ECM_tab_23$dis3_23[i] &lt;- (deviance(mod3) / df.residual(mod3))\n  ECM_tab_23$dis4_23[i] &lt;- (deviance(mod4) / df.residual(mod4))\n  \n  # Lista de modelos y de tablas\n  mods &lt;- list(mod1, mod2, mod3, mod4)\n  tabs &lt;- list(TAB1_23, TAB2_23, TAB3_23, TAB4_23)\n\n  for (j in seq_along(mods)) {\n    tabs[[j]][i, ] &lt;- sapply(1:7, function(k) {\n    as.integer(anova(mods[[j]])[k, 5] &lt;= 0.05) })}\n  \n  ## Evaluación del diseño con réplicas y con cinco puntos centrales\n  TAB1_23 &lt;- tabs[[1]] \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  TAB2_23 &lt;- tabs[[2]] \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  TAB3_23 &lt;- tabs[[3]]  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  TAB4_23 &lt;- tabs[[4]]}  \n\n\n\n\n3.2.2 Potencia y error tipo I\n\n\nCódigo\n## Evaluación del diseño con réplicas y con cinco puntos centrales\ncomp1_23 &lt;- round(colSums(efectos_reales_23 == TAB1_23) / n * 100, 2)\npot1_23 &lt;- round(colSums((efectos_reales_23 == 1) & (TAB1_23 == 1)) /\n                colSums(efectos_reales_23 == 1) * 100, 2)\nerr1_23 &lt;- round(colSums((efectos_reales_23 == 0) & (TAB1_23 == 1)) /\n                colSums(efectos_reales_23 == 0) * 100, 2)\n\n## Evaluación del diseño con réplicas y sin puntos centrales\ncomp2_23 &lt;- round(colSums(efectos_reales_23 == TAB2_23) / n * 100, 2)\npot2_23 &lt;- round(colSums((efectos_reales_23 == 1) & (TAB2_23 == 1)) / \n                colSums(efectos_reales_23 == 1) * 100, 2)\nerr2_23 &lt;- round(colSums((efectos_reales_23 == 0) & (TAB2_23 == 1)) / \n                colSums(efectos_reales_23 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con cinco puntos centrales\ncomp3_23 &lt;- round(colSums(efectos_reales_23 == TAB3_23) / n * 100, 2)\npot3_23 &lt;- round(colSums((efectos_reales_23 == 1) & (TAB3_23 == 1)) / \n                colSums(efectos_reales_23 == 1) * 100, 2)\nerr3_23 &lt;- round(colSums((efectos_reales_23 == 0) & (TAB3_23 == 1)) / \n                colSums(efectos_reales_23 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con dos puntos centrales\ncomp4_23 &lt;- round(colSums(efectos_reales_23 == TAB4_23) / n * 100, 2)\npot4_23 &lt;- round(colSums((efectos_reales_23 == 1) & (TAB4_23 == 1)) / \n                colSums(efectos_reales_23 == 1) * 100, 2)\nerr4_23 &lt;- round(colSums((efectos_reales_23 == 0) & (TAB4_23 == 1)) / \n                colSums(efectos_reales_23 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y sin puntos centrales\ncomp6_23 &lt;- round(colSums(efectos_reales_23 == TAB6_23) / n * 100, 2)\npot6_23 &lt;- round(colSums((efectos_reales_23 == 1) & (TAB6_23 == 1)) /\n                colSums(efectos_reales_23 == 1) * 100, 2)\nerr6_23 &lt;- round(colSums((efectos_reales_23 == 0) & (TAB6_23 == 1)) /\n                colSums(efectos_reales_23 == 0) * 100, 2)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-factorial-completo-24",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-factorial-completo-24",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "3.3 Diseño factorial completo \\(2^4\\)",
    "text": "3.3 Diseño factorial completo \\(2^4\\)\n\n3.3.1 Significancia de los efectos\n\n\nCódigo\n# Matrices\nTAB1_24 &lt;- matrix(0, nrow = n, ncol = 15)\nTAB2_24 &lt;- matrix(0, nrow = n, ncol = 15)\nTAB3_24 &lt;- matrix(0, nrow = n, ncol = 15)\nTAB4_24 &lt;- matrix(0, nrow = n, ncol = 15)\nTAB6_24 &lt;- matrix(0, nrow = n, ncol = 15)\nefectos_reales_24 &lt;- matrix(0, nrow = n, ncol = 15)\n\nnames_24 &lt;- c(\"A\", \"B\", \"C\", \"D\",\n  \"A:B\", \"A:C\", \"B:C\", \"A:D\", \"B:D\", \"C:D\",\n  \"A:B:C\", \"A:B:D\", \"A:C:D\", \"B:C:D\",\n  \"A:B:C:D\")\n\ncolnames(TAB1_24) &lt;- names_24\ncolnames(TAB2_24) &lt;- names_24\ncolnames(TAB3_24) &lt;- names_24\ncolnames(TAB4_24) &lt;- names_24\ncolnames(TAB6_24) &lt;- names_24\ncolnames(efectos_reales_24) &lt;- names_24\n\n# Tabla para completar los errores\nECM_tab_24 &lt;- data.frame(       \n    dis1_24 = numeric(n),\n    dis2_24 = numeric(n),\n    dis3_24 = numeric(n),\n    dis4_24 = numeric(n))\n\n# Bucle principal\nset.seed(3)\nfor(i in seq_len(n)){\n  ## Efectos a evaluar en el este diseño\n  todos_efectos_24 &lt;- c(\"A\", \"B\", \"C\", \"D\",\n  \"A:B\", \"A:C\", \"B:C\", \"A:D\", \"B:D\", \"C:D\",\n  \"A:B:C\", \"A:B:D\", \"A:C:D\", \"B:C:D\",\n  \"A:B:C:D\")\n  \n  # Selección de un número aleatorio entre 1 y 15\n  # dado que existen 15 efectos posibles a evaluar en este diseño.\n  n_ef &lt;- sample(0:length(todos_efectos_24), 1)\n  \n  # Elección aleatoria _n_ef_ efectos que serán los efectos significativos\n  efectos_activos &lt;- sample(todos_efectos_24, n_ef)\n  efectos_reales_24_vec &lt;- setNames(rep(0, length(todos_efectos_24)), todos_efectos_24)\n  \n  # Asignación de un valor aleatorio a los efectos elegidos como significativos:\n  efectos_reales_24_vec[efectos_activos] &lt;- sample(c(runif(n_ef, -7, -0.5), \n                                                  runif(n_ef,  0.5, 7)),n_ef)\n  \n  # Guardar efectos reales como 1/0\n  efectos_reales_24[i, ] &lt;- c(\n    as.integer(efectos_reales_24_vec[\"A\"]       != 0),\n    as.integer(efectos_reales_24_vec[\"B\"]       != 0),\n    as.integer(efectos_reales_24_vec[\"C\"]       != 0),\n    as.integer(efectos_reales_24_vec[\"D\"]       != 0),\n    as.integer(efectos_reales_24_vec[\"A:B\"]     != 0),\n    as.integer(efectos_reales_24_vec[\"A:C\"]     != 0),\n    as.integer(efectos_reales_24_vec[\"B:C\"]     != 0),\n    as.integer(efectos_reales_24_vec[\"A:D\"]     != 0),\n    as.integer(efectos_reales_24_vec[\"B:D\"]     != 0),\n    as.integer(efectos_reales_24_vec[\"C:D\"]     != 0),\n    as.integer(efectos_reales_24_vec[\"A:B:C\"]   != 0),\n    as.integer(efectos_reales_24_vec[\"A:B:D\"]   != 0),\n    as.integer(efectos_reales_24_vec[\"A:C:D\"]   != 0),\n    as.integer(efectos_reales_24_vec[\"B:C:D\"]   != 0),\n    as.integer(efectos_reales_24_vec[\"A:B:C:D\"] != 0))\n    \n  # Generar respuesta\n  \n  ## Diseño de variables codificadas con réplicas y con 5 puntos centrales\n \n  dis1_cod &lt;- data.frame(\n      A = c(rep(c(-1,1), 8), rep(c(-1,1), 8), rep(0,5)),\n      B = c(rep(c(rep(-1,2), rep(1,2)), 4),\n            rep(c(rep(-1,2), rep(1,2)), 4),\n            rep(0,5)),\n      C = c(rep(c(rep(-1,4), rep(1,4)), 2),\n            rep(c(rep(-1,4), rep(1,4)), 2),\n            rep(0,5)),\n      D = c(rep(-1,8), rep(1,8),\n            rep(-1,8), rep(1,8),\n            rep(0,5)))\n \n  n_corridas &lt;- nrow(dis1_cod)\n  \n  ## Generación del error\n  error &lt;- rnorm(n_corridas, 0, 2)       #error ~ (mu = 0, sigma^2 = 2^2)\n  \n  ## Generación de la respuesta\n  yrta &lt;- 50 +\n  efectos_reales_24_vec[\"A\"]       * dis1_cod$A +\n  efectos_reales_24_vec[\"B\"]       * dis1_cod$B +\n  efectos_reales_24_vec[\"C\"]       * dis1_cod$C +\n  efectos_reales_24_vec[\"D\"]       * dis1_cod$D +\n  efectos_reales_24_vec[\"A:B\"]     * dis1_cod$A * dis1_cod$B +\n  efectos_reales_24_vec[\"A:C\"]     * dis1_cod$A * dis1_cod$C +\n  efectos_reales_24_vec[\"B:C\"]     * dis1_cod$B * dis1_cod$C +\n  efectos_reales_24_vec[\"A:D\"]     * dis1_cod$A * dis1_cod$D +\n  efectos_reales_24_vec[\"B:D\"]     * dis1_cod$B * dis1_cod$D +\n  efectos_reales_24_vec[\"C:D\"]     * dis1_cod$C * dis1_cod$D +\n  efectos_reales_24_vec[\"A:B:C\"]   * dis1_cod$A * dis1_cod$B * dis1_cod$C +\n  efectos_reales_24_vec[\"A:B:D\"]   * dis1_cod$A * dis1_cod$B * dis1_cod$D +\n  efectos_reales_24_vec[\"A:C:D\"]   * dis1_cod$A * dis1_cod$C * dis1_cod$D +\n  efectos_reales_24_vec[\"B:C:D\"]   * dis1_cod$B * dis1_cod$C * dis1_cod$D +\n  efectos_reales_24_vec[\"A:B:C:D\"] * dis1_cod$A * dis1_cod$B * dis1_cod$C * dis1_cod$D +\n  error\n  \n  ## Asignación de la respuesta al dis1_cod\n  dis1_cod &lt;- cbind(dis1_cod, yrta)\n \n  ## Diseño con réplicas y sin puntos centrales\n  \n  dis2_cod &lt;- dis1_cod[-c(33:37),]\n  \n  ## Diseño sin réplica y con cinco puntos centrales\n  rep1 &lt;- c(1:16)\n  rep2 &lt;- c(17:32)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis3_cod &lt;- dis1_cod[-sel,]      \n  \n  ## Diseño sin réplica y con dos puntos centrales\n  rep1 &lt;- c(1:16)\n  rep2 &lt;- c(17:32)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  rep_pc &lt;- sample(c(33:37),3)                   #punto central a eliminar\n  \n  dis4_cod &lt;- dis1_cod[-c(sel,rep_pc),]     \n  \n  ## Diseño sin réplica y sin puntos centrales\n  rep1 &lt;- c(1:16, 33:37)\n  rep2 &lt;- c(17:32, 33:37)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis6_cod &lt;- dis1_cod[-sel,] \n  \n  mod6 &lt;- lm(yrta~A*B*C*D, data=dis6_cod)\n  \n  graf &lt;- suppressMessages(halfnormal(mod6, alpha = 0.05, plot=FALSE, method=\"Lenth\"))\n  signif &lt;- graf$signif\n  TAB6_24[i, todos_efectos_24 %in% signif] &lt;- 1\n  \n  # Modelo\n  ## Evaluación del diseño con réplicas y con cinco puntos centrales\n  mod1 &lt;- lm(yrta~A*B*C*D, data=dis1_cod)  \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  mod2 &lt;- lm(yrta~A*B*C*D, data=dis2_cod)  \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  mod3 &lt;- lm(yrta~A*B*C*D, data=dis3_cod)  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  mod4 &lt;- lm(yrta~A*B*C*D, data=dis4_cod)  \n  ## Almacenar los ECM\n  ECM_tab_24$dis1_24[i] &lt;- (deviance(mod1) / df.residual(mod1))\n  ECM_tab_24$dis2_24[i] &lt;- (deviance(mod2) / df.residual(mod2))\n  ECM_tab_24$dis3_24[i] &lt;- (deviance(mod3) / df.residual(mod3))\n  ECM_tab_24$dis4_24[i] &lt;- (deviance(mod4) / df.residual(mod4))\n  \n  # Lista de modelos y de tablas\n  mods &lt;- list(mod1, mod2, mod3, mod4)\n  tabs &lt;- list(TAB1_24, TAB2_24, TAB3_24, TAB4_24)\n\n  for (j in seq_along(mods)) {\n    tabs[[j]][i, ] &lt;- sapply(1:15, function(k) {\n      as.integer(anova(mods[[j]])[k, 5] &lt;= 0.05) })}\n  \n  ## Diseño con réplicas y con cinco puntos centrales\n  TAB1_24 &lt;- tabs[[1]] \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  TAB2_24 &lt;- tabs[[2]] \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  TAB3_24 &lt;- tabs[[3]]  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  TAB4_24 &lt;- tabs[[4]]}  \n\n\n\n\n3.3.2 Potencia y error tipo I\n\n\nCódigo\n## Evaluación del diseño con réplicas y con cinco puntos centrales\ncomp1_24 &lt;- round(colSums(efectos_reales_24 == TAB1_24) / n * 100, 2)\npot1_24 &lt;- round(colSums((efectos_reales_24 == 1) & (TAB1_24 == 1)) /\n                colSums(efectos_reales_24 == 1) * 100, 2)\nerr1_24 &lt;- round(colSums((efectos_reales_24 == 0) & (TAB1_24 == 1)) /\n                colSums(efectos_reales_24 == 0) * 100, 2)\n\n## Evaluación del diseño con réplicas y sin puntos centrales\ncomp2_24 &lt;- round(colSums(efectos_reales_24 == TAB2_24) / n * 100, 2)\npot2_24 &lt;- round(colSums((efectos_reales_24 == 1) & (TAB2_24 == 1)) / \n                colSums(efectos_reales_24 == 1) * 100, 2)\nerr2_24 &lt;- round(colSums((efectos_reales_24 == 0) & (TAB2_24 == 1)) / \n                colSums(efectos_reales_24 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con cinco puntos centrales\ncomp3_24 &lt;- round(colSums(efectos_reales_24 == TAB3_24) / n * 100, 2)\npot3_24 &lt;- round(colSums((efectos_reales_24 == 1) & (TAB3_24 == 1)) / \n                colSums(efectos_reales_24 == 1) * 100, 2)\nerr3_24 &lt;- round(colSums((efectos_reales_24 == 0) & (TAB3_24 == 1)) / \n                colSums(efectos_reales_24 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con dos puntos centrales\ncomp4_24 &lt;- round(colSums(efectos_reales_24 == TAB4_24) / n * 100, 2)\npot4_24 &lt;- round(colSums((efectos_reales_24 == 1) & (TAB4_24 == 1)) / \n                colSums(efectos_reales_24 == 1) * 100, 2)\nerr4_24 &lt;- round(colSums((efectos_reales_24 == 0) & (TAB4_24 == 1)) / \n                colSums(efectos_reales_24 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y sin puntos centrales\ncomp6_24 &lt;- round(colSums(efectos_reales_24 == TAB6_24) / n * 100, 2)\npot6_24 &lt;- round(colSums((efectos_reales_24 == 1) & (TAB6_24 == 1)) /\n                colSums(efectos_reales_24 == 1) * 100, 2)\nerr6_24 &lt;- round(colSums((efectos_reales_24 == 0) & (TAB6_24 == 1)) /\n                colSums(efectos_reales_24 == 0) * 100, 2)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-factorial-completo-25",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-factorial-completo-25",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "3.4 Diseño factorial completo \\(2^5\\)",
    "text": "3.4 Diseño factorial completo \\(2^5\\)\n\n3.4.1 Significancia de los efectos\n\n\nCódigo\n# Matrices\nTAB1_25 &lt;- matrix(NA, nrow = n, ncol = 31)\nTAB2_25 &lt;- matrix(NA, nrow = n, ncol = 31)\nTAB3_25 &lt;- matrix(NA, nrow = n, ncol = 31)\nTAB4_25 &lt;- matrix(NA, nrow = n, ncol = 31)\nTAB6_25 &lt;- matrix(0, nrow = n, ncol = 31)\nefectos_reales_25 &lt;- matrix(0, nrow = n, ncol = 31)\n\nnames_25 &lt;- c(\"A\",\"B\",\"C\",\"D\",\"E\", \n           \"A:B\",\"A:C\",\"B:C\",\"A:D\",\"B:D\",\"C:D\",\"A:E\",\"B:E\",\"C:E\",\"D:E\",\n           \"A:B:C\",\"A:B:D\",\"A:C:D\",\"B:C:D\",\"A:B:E\",\"A:C:E\",\"B:C:E\",\"A:D:E\",\"B:D:E\",\"C:D:E\",\n           \"A:B:C:D\",\"A:B:C:E\",\"A:B:D:E\",\"A:C:D:E\",\"B:C:D:E\",\n           \"A:B:C:D:E\")\n\ncolnames(TAB1_25) &lt;- names_25\ncolnames(TAB2_25) &lt;- names_25\ncolnames(TAB3_25) &lt;- names_25\ncolnames(TAB4_25) &lt;- names_25\ncolnames(TAB6_25) &lt;- names_25\ncolnames(efectos_reales_25) &lt;- names_25\n\n# Tabla para completar los errores\nECM_tab_25 &lt;- data.frame(       \n    dis1_25 = numeric(n),\n    dis2_25 = numeric(n),\n    dis3_25 = numeric(n),\n    dis4_25 = numeric(n))\n\n# Bucle principal\nset.seed(3)\nfor(i in seq_len(n)){\n  ## Efectos a evaluar en el este diseño\n  todos_efectos_25 &lt;- c(\"A\",\"B\",\"C\",\"D\",\"E\", \n           \"A:B\",\"A:C\",\"B:C\",\"A:D\",\"B:D\",\"C:D\",\"A:E\",\"B:E\",\"C:E\",\"D:E\",\n           \"A:B:C\",\"A:B:D\",\"A:C:D\",\"B:C:D\",\"A:B:E\",\"A:C:E\",\"B:C:E\",\"A:D:E\",\"B:D:E\",\"C:D:E\",\n           \"A:B:C:D\",\"A:B:C:E\",\"A:B:D:E\",\"A:C:D:E\",\"B:C:D:E\",\n           \"A:B:C:D:E\")\n  \n  # Selección de un número aleatorio entre 1 y 31\n  # dado que existen 31 efectos posibles a evaluar en este diseño.\n  n_ef &lt;- sample(0:length(todos_efectos_25), 1)\n  \n  # Elección aleatoria _n_ef_ efectos que serán los efectos significativos\n  efectos_activos &lt;- sample(todos_efectos_25, n_ef)\n  efectos_reales_25_vec &lt;- setNames(rep(0, length(todos_efectos_25)), todos_efectos_25)\n  \n  # Asignación de un valor aleatorio a los efectos elegidos como significativos:\n  efectos_reales_25_vec[efectos_activos] &lt;- sample(c(runif(n_ef, -7, -0.5), \n                                                  runif(n_ef,  0.5, 7)),n_ef)\n  \n  # Guardar efectos reales como 1/0\n  efectos_reales_25[i, ] &lt;- c(\n    as.integer(efectos_reales_25_vec[\"A\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"B\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"C\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"D\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"E\"]    != 0),\n    \n    as.integer(efectos_reales_25_vec[\"A:B\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"A:C\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"B:C\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"A:D\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"B:D\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"C:D\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"A:E\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"B:E\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"C:E\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"D:E\"]   != 0),\n    \n    as.integer(efectos_reales_25_vec[\"A:B:C\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"A:B:D\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"A:C:D\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"B:C:D\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"A:B:E\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"A:C:E\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"B:C:E\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"A:D:E\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"B:D:E\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"C:D:E\"]    != 0),\n    \n    as.integer(efectos_reales_25_vec[\"A:B:C:D\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"A:B:C:E\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"A:B:D:E\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"A:C:D:E\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"B:C:D:E\"]  != 0),\n    \n    as.integer(efectos_reales_25_vec[\"A:B:C:D:E\"]!= 0))\n    \n  # Generar respuesta\n  \n  ## Diseño de variables codificadas con réplicas y con 5 puntos centrales\n \n  dis1_cod &lt;- data.frame(\n  A = c(rep(c(-1,1),16), rep(c(-1,1),16), rep(0,5)),\n  B = c(rep(c(rep(-1,2), rep(1,2)),8),  rep(c(rep(-1,2), rep(1,2)),8),rep(0,5)),\n  C = c(rep(c(rep(-1,4), rep(1,4)),4), rep(c(rep(-1,4), rep(1,4)),4),rep(0,5)),\n  D = c(rep(c(rep(-1,8), rep(1,8)),2), rep(c(rep(-1,8), rep(1,8)),2),rep(0,5)),\n  E = c(rep(-1,16), rep(1,16), rep(-1,16), rep(1,16), rep(0,5)))\n \n  n_corridas &lt;- nrow(dis1_cod)\n  \n  ## Generación del error\n  error &lt;- rnorm(n_corridas, 0, 2)       #error ~ (mu = 0, sigma^2 = 2^2)\n  \n  ## Generación de la respuesta\n  yrta &lt;- 50 +\n  efectos_reales_25_vec[\"A\"]     * dis1_cod$A +\n  efectos_reales_25_vec[\"B\"]     * dis1_cod$B +\n  efectos_reales_25_vec[\"C\"]     * dis1_cod$C +\n  efectos_reales_25_vec[\"D\"]     * dis1_cod$D +\n  efectos_reales_25_vec[\"E\"]     * dis1_cod$E +\n  \n  efectos_reales_25_vec[\"A:B\"]    * dis1_cod$A * dis1_cod$B +\n  efectos_reales_25_vec[\"A:C\"]    * dis1_cod$A * dis1_cod$C +\n  efectos_reales_25_vec[\"B:C\"]    * dis1_cod$B * dis1_cod$C +\n  efectos_reales_25_vec[\"A:D\"]    * dis1_cod$A * dis1_cod$D +\n  efectos_reales_25_vec[\"B:D\"]    * dis1_cod$B * dis1_cod$D +\n  efectos_reales_25_vec[\"C:D\"]    * dis1_cod$C * dis1_cod$D +\n  efectos_reales_25_vec[\"A:E\"]    * dis1_cod$A * dis1_cod$E +\n  efectos_reales_25_vec[\"B:E\"]    * dis1_cod$B * dis1_cod$E +\n  efectos_reales_25_vec[\"C:E\"]    * dis1_cod$C * dis1_cod$E +\n  efectos_reales_25_vec[\"D:E\"]    * dis1_cod$D * dis1_cod$E +\n  \n  efectos_reales_25_vec[\"A:B:C\"]   * dis1_cod$A * dis1_cod$B * dis1_cod$C +\n  efectos_reales_25_vec[\"A:B:D\"]   * dis1_cod$A * dis1_cod$B * dis1_cod$D +\n  efectos_reales_25_vec[\"A:C:D\"]   * dis1_cod$A * dis1_cod$C * dis1_cod$D +\n  efectos_reales_25_vec[\"B:C:D\"]   * dis1_cod$B * dis1_cod$C * dis1_cod$D +\n  efectos_reales_25_vec[\"A:B:E\"]   * dis1_cod$A * dis1_cod$B * dis1_cod$E +\n  efectos_reales_25_vec[\"A:C:E\"]   * dis1_cod$A * dis1_cod$C * dis1_cod$E +\n  efectos_reales_25_vec[\"B:C:E\"]   * dis1_cod$B * dis1_cod$C * dis1_cod$E +\n  efectos_reales_25_vec[\"A:D:E\"]   * dis1_cod$A * dis1_cod$D * dis1_cod$E +\n  efectos_reales_25_vec[\"B:D:E\"]   * dis1_cod$B * dis1_cod$D * dis1_cod$E +\n  efectos_reales_25_vec[\"C:D:E\"]   * dis1_cod$C * dis1_cod$D * dis1_cod$E +\n  \n  efectos_reales_25_vec[\"A:B:C:D\"]  * dis1_cod$A * dis1_cod$B * dis1_cod$C * dis1_cod$D +\n  efectos_reales_25_vec[\"A:B:C:E\"]  * dis1_cod$A * dis1_cod$B * dis1_cod$C * dis1_cod$E +\n  efectos_reales_25_vec[\"A:B:D:E\"]  * dis1_cod$A * dis1_cod$B * dis1_cod$D * dis1_cod$E +\n  efectos_reales_25_vec[\"A:C:D:E\"]  * dis1_cod$A * dis1_cod$C * dis1_cod$D * dis1_cod$E +\n  efectos_reales_25_vec[\"B:C:D:E\"]  * dis1_cod$B * dis1_cod$C * dis1_cod$D * dis1_cod$E +\n  \n  efectos_reales_25_vec[\"A:B:C:D:E\"] * dis1_cod$A * dis1_cod$B * dis1_cod$C * dis1_cod$D * dis1_cod$E +\n  \n  error\n  \n  ## Asignación de la respuesta al dis1_cod\n  dis1_cod &lt;- cbind(dis1_cod, yrta)\n \n  ## Diseño con réplicas y sin puntos centrales\n  \n  dis2_cod &lt;- dis1_cod[-c(65:69),]\n  \n  ## Diseño sin réplica y con cinco puntos centrales\n  rep1 &lt;- c(1:32)\n  rep2 &lt;- c(33:64)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis3_cod &lt;- dis1_cod[-sel,]      \n  \n  ## Diseño sin réplica y con dos puntos centrales\n  rep1 &lt;- c(1:32)\n  rep2 &lt;- c(33:64)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  rep_pc &lt;- sample(c(65:69),3)                   #punto central a eliminar\n  \n  dis4_cod &lt;- dis1_cod[-c(sel,rep_pc),]     \n  \n  ## Diseño sin réplicas y sin puntos centrales\n  rep1 &lt;- c(1:32, 65:69)\n  rep2 &lt;- c(33:64, 65:69)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n\n  dis6_cod &lt;- dis1_cod[-sel,] \n  \n  mod6 &lt;- lm(yrta~A*B*C*D*E, data=dis6_cod)\n  \n  graf &lt;- suppressMessages(halfnormal(mod6, alpha = 0.05, plot=FALSE, method=\"Lenth\"))\n  signif &lt;- graf$signif\n  TAB6_25[i, todos_efectos_25 %in% signif] &lt;- 1\n  \n  # Modelo\n  ## Evaluación del diseño con réplicas y con cinco puntos centrales\n  mod1 &lt;- lm(yrta~A*B*C*D*E, data=dis1_cod)  \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  mod2 &lt;- lm(yrta~A*B*C*D*E, data=dis2_cod)  \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  mod3 &lt;- lm(yrta~A*B*C*D*E, data=dis3_cod)  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  mod4 &lt;- lm(yrta~A*B*C*D*E, data=dis4_cod)  \n  ## Almacenar los ECM\n  ECM_tab_25$dis1_25[i] &lt;- (deviance(mod1) / df.residual(mod1))\n  ECM_tab_25$dis2_25[i] &lt;- (deviance(mod2) / df.residual(mod2))\n  ECM_tab_25$dis3_25[i] &lt;- (deviance(mod3) / df.residual(mod3))\n  ECM_tab_25$dis4_25[i] &lt;- (deviance(mod4) / df.residual(mod4))\n  \n  # Lista de modelos y de tablas\n  mods &lt;- list(mod1, mod2, mod3, mod4)\n  tabs &lt;- list(TAB1_25, TAB2_25, TAB3_25, TAB4_25)\n\n  for (j in seq_along(mods)) {\n    tabs[[j]][i, ] &lt;- sapply(1:31, function(k) {\n      as.integer(anova(mods[[j]])[k, 5] &lt;= 0.05) })}\n  \n  ## Diseño con réplicas y con cinco puntos centrales\n  TAB1_25 &lt;- tabs[[1]] \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  TAB2_25 &lt;- tabs[[2]] \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  TAB3_25 &lt;- tabs[[3]]  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  TAB4_25 &lt;- tabs[[4]]}  \n\n\n\n\n3.4.2 Potencia y error tipo I\n\n\nCódigo\n## Evaluación del diseño con réplicas y con cinco puntos centrales\ncomp1_25 &lt;- round(colSums(efectos_reales_25 == TAB1_25) / n * 100, 2)\npot1_25 &lt;- round(colSums((efectos_reales_25 == 1) & (TAB1_25 == 1)) /\n                colSums(efectos_reales_25 == 1) * 100, 2)\nerr1_25 &lt;- round(colSums((efectos_reales_25 == 0) & (TAB1_25 == 1)) /\n                colSums(efectos_reales_25 == 0) * 100, 2)\n\n## Evaluación del diseño con réplicas y sin puntos centrales\ncomp2_25 &lt;- round(colSums(efectos_reales_25 == TAB2_25) / n * 100, 2)\npot2_25 &lt;- round(colSums((efectos_reales_25 == 1) & (TAB2_25 == 1)) / \n                colSums(efectos_reales_25 == 1) * 100, 2)\nerr2_25 &lt;- round(colSums((efectos_reales_25 == 0) & (TAB2_25 == 1)) / \n                colSums(efectos_reales_25 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con cinco puntos centrales\ncomp3_25 &lt;- round(colSums(efectos_reales_25 == TAB3_25) / n * 100, 2)\npot3_25 &lt;- round(colSums((efectos_reales_25 == 1) & (TAB3_25 == 1)) / \n                colSums(efectos_reales_25 == 1) * 100, 2)\nerr3_25 &lt;- round(colSums((efectos_reales_25 == 0) & (TAB3_25 == 1)) / \n                colSums(efectos_reales_25 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con dos puntos centrales\ncomp4_25 &lt;- round(colSums(efectos_reales_25 == TAB4_25) / n * 100, 2)\npot4_25 &lt;- round(colSums((efectos_reales_25 == 1) & (TAB4_25 == 1)) / \n                colSums(efectos_reales_25 == 1) * 100, 2)\nerr4_25 &lt;- round(colSums((efectos_reales_25 == 0) & (TAB4_25 == 1)) / \n                colSums(efectos_reales_25 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y sin puntos centrales\ncomp6_25 &lt;- round(colSums(efectos_reales_25 == TAB6_25) / n * 100, 2)\npot6_25 &lt;- round(colSums((efectos_reales_25 == 1) & (TAB6_25 == 1)) /\n                colSums(efectos_reales_25 == 1) * 100, 2)\nerr6_25 &lt;- round(colSums((efectos_reales_25 == 0) & (TAB6_25 == 1)) /\n                colSums(efectos_reales_25 == 0) * 100, 2)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#evaluación-del-error-cuadrático-medio-ecm-por-medidas-repetidas",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#evaluación-del-error-cuadrático-medio-ecm-por-medidas-repetidas",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "3.5 Evaluación del Error Cuadrático Medio (ECM) por medidas repetidas",
    "text": "3.5 Evaluación del Error Cuadrático Medio (ECM) por medidas repetidas\nPara la evaluación del Error Cuadrático Medio (ECM) se diseñó la siguiente función:\n\n\nCódigo\n# X: Matriz que incluye los datos para comparar que debe estar organizada así\n# C: Matriz de contrastes\n# alpha: Nivel de significancia\n\nHotelling &lt;- function(X, C, alpha) {\n  \n  ## Cálculo de la $T^2$ Hotelling\n  mu &lt;- colMeans(X)\n  n &lt;- nrow(X)   # Número de individuos (filas de X)\n  p &lt;- ncol(X)   # Número de tratamientos (columnas de X)\n  \n  # Matriz identidad e I - (1/n)11'\n  In &lt;- diag(n)\n  uno &lt;- matrix(1, n, n)   # 1 x t(1)\n  H &lt;- In - (1/n) * uno\n  \n  # Calculo de S\n  S &lt;- (1/(n-1)) * t(X) %*% H %*% X\n  \n  # Cálculo de T2\n  T2 &lt;- n*(t(C%*%mu))%*%(solve(C%*%S%*%t(C)))%*%(C%*%mu)\n  \n  # F calculado\n  Fcal &lt;- (n - p + 1) / ((n - 1)*(p - 1)) * T2\n  \n  # F tabulado (crítico)\n  gl1 &lt;- p-1\n  gl2 &lt;- n-p+1\n  \n  # Valor crítico F(0.05; p-1, n-p+1)\n  F_critico &lt;- qf(1-alpha, df1 = gl1, df2 = gl2)\n\n  return(list(\n    T2 = as.numeric(T2),\n    Fcal = as.numeric(Fcal),\n    F_critico = F_critico))\n}",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-factorial-completo-22-1",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-factorial-completo-22-1",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "4.1 Diseño factorial completo \\(2^2\\)",
    "text": "4.1 Diseño factorial completo \\(2^2\\)\n\n\n\n\n\nFactoresCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas sin puntos centrales (Lenth)Sin réplicas sin puntos centrales (Lenth)Sin réplicas sin puntos centrales (Lenth)ConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IA10010009075010010009075.000600.000B1001000100100010010008066.6706033.330A:B9075090750805008050.000600.000\n\n\n\nTabla 4.1: Concordancia porcentual en la significancia de los efectos según réplicas y puntos centrales en el diseño experimental 2²\n\n\n\n\n\n\n\n\n\n\n\n\nFigura 4.1",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-factorial-completo-23-1",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-factorial-completo-23-1",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "4.2 Diseño factorial completo \\(2^3\\)",
    "text": "4.2 Diseño factorial completo \\(2^3\\)\n\n\n\n\n\nFactoresCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas sin puntos centrales (Lenth)Sin réplicas sin puntos centrales (Lenth)Sin réplicas sin puntos centrales (Lenth)ConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IA100100.0008075.0016.67100100.0007075.0033.337025.000B9083.3309083.330.009083.3308066.670.005016.670C100100.000100100.000.00100100.0008075.0016.67600.000A:B100100.000100100.000.009066.6708066.6714.29700.000A:C9083.3309083.330.009083.3309083.330.006033.330B:C9083.3309083.330.008066.6706050.0025.00400.000A:B:C9080.0009080.000.009080.0007060.0020.006020.000\n\n\n\nTabla 4.2: Concordancia porcentual en la significancia de los efectos según réplicas y puntos centrales en el diseño experimental 2³\n\n\n\n\n\n\n\n\n\n\n\n\nFigura 4.2",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-factorial-completo-24-1",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-factorial-completo-24-1",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "4.3 Diseño factorial completo \\(2^4\\)",
    "text": "4.3 Diseño factorial completo \\(2^4\\)\n\n\n\n\n\nFactoresCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas sin puntos centrales (Lenth)Sin réplicas sin puntos centrales (Lenth)Sin réplicas sin puntos centrales (Lenth)ConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IA10010001001000100100.000.0090100.0020.006020.000B10010001001000100100.000.007080.0040.006020.000C901002590100258066.670.007066.6725.005033.3325D100100010010009083.330.006050.0025.006033.330A:B10010001001000100100.000.008083.3325.004016.6725A:C100100010010008066.670.006050.0025.006033.330B:C10010001001000100100.000.0090100.0025.007050.000A:D10010001001000100100.000.007083.3350.005016.670B:D1001000100100090100.0025.008083.3325.006033.330C:D100100010010008075.000.007075.0050.005037.500A:B:C100100010010007050.0016.678075.0016.67600.000A:B:D10010001001000100100.000.0080100.0050.006033.330A:C:D10010001001000100100.000.0070100.0050.007025.000B:C:D90100209010020100100.000.0070100.0060.005020.0020A:B:C:D100100010010009080.000.008060.000.006020.000\n\n\n\nTabla 4.3: Concordancia porcentual en la significancia de los efectos según réplicas y puntos centrales en el diseño experimental 2⁴\n\n\n\n\n\n\n\n\n\n\n\n\nFigura 4.3",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-factorial-completo-25-1",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-factorial-completo-25-1",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "4.4 Diseño factorial completo \\(2^5\\)",
    "text": "4.4 Diseño factorial completo \\(2^5\\)\n\n\n\n\n\nFactoresCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas sin puntos centrales (Lenth)Sin réplicas sin puntos centrales (Lenth)Sin réplicas sin puntos centrales (Lenth)ConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IA100100.000.00100100.000.00100100.000.001001000.009050.000.00B100100.000.00100100.000.0090100.0025.001001000.009083.330.00C100100.000.00100100.000.00100100.000.009010012.509050.000.00D100100.000.00100100.000.0080100.0025.008010025.008050.0012.50E90100.0016.6790100.0016.6790100.0016.679010016.677075.0033.33A:B100100.000.00100100.000.0090100.0014.291001000.009066.670.00A:C90100.0012.5090100.0012.5090100.0012.501001000.009050.000.00B:C100100.000.00100100.000.00100100.000.001001000.009050.000.00A:D90100.0012.5090100.0012.509050.000.0090500.00800.000.00B:D100100.000.00100100.000.0090100.0014.299010014.299066.670.00C:D100100.000.0090100.0014.2990100.0014.298010028.579066.670.00A:E100100.000.00100100.000.00100100.000.001001000.009075.000.00B:E100100.000.00100100.000.00100100.000.009010014.299066.670.00C:E100100.000.00100100.000.00100100.000.001001000.009066.670.00D:E100100.000.0090100.0014.29100100.000.001001000.009066.670.00A:B:C100100.000.00100100.000.00100100.000.009010014.299066.670.00A:B:D100100.000.00100100.000.0090100.0012.501001000.008050.0012.50A:C:D100100.000.00100100.000.0090100.0014.291001000.009066.670.00B:C:D100100.000.00100100.000.00100100.000.009010014.298033.330.00A:B:E100100.000.00100100.000.008050.0012.508010025.007050.0025.00A:C:E90100.0011.1190100.0011.11100100.000.001001000.00900.000.00B:C:E9066.670.009066.670.009066.670.001001000.008033.330.00A:D:E80100.0025.0080100.0025.00100100.000.009010012.5090100.0012.50B:D:E9050.000.009050.000.00100100.000.0060025.009050.000.00C:D:E100100.000.00100100.000.00100100.000.001001000.009075.000.00A:B:C:D100100.000.00100100.000.0090100.0016.671001000.009075.000.00A:B:C:E90100.0012.5090100.0012.5090100.0012.509010012.509050.000.00A:B:D:E100100.000.00100100.000.00100100.000.001001000.009066.670.00A:C:D:E90100.0025.0090100.0025.0080100.0050.001001000.008083.3325.00B:C:D:E100100.000.00100100.000.00100100.000.001001000.006033.3328.57A:B:C:D:E90100.0011.1190100.0011.11100100.000.001001000.00900.000.00\n\n\n\nTabla 4.4: Concordancia porcentual en la significancia de los efectos según réplicas y puntos centrales en el diseño experimental 2⁵\n\n\n\n\n\n\n\n\n\n\n\n\nFigura 4.4",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#evaluación-del-ecm-por-medidas-repetidas-para-todos-los-tratamientos",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#evaluación-del-ecm-por-medidas-repetidas-para-todos-los-tratamientos",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "4.5 Evaluación del ECM por medidas repetidas para todos los tratamientos",
    "text": "4.5 Evaluación del ECM por medidas repetidas para todos los tratamientos\n\n4.5.1 Análisis descriptivo de los ECM por diseño\n\n\n\n\n\n\n\n\nFigura 4.5: Análisis descriptivo de los ECM por diseño factorial\n\n\n\n\n\n\n\n4.5.2 Matriz de contrastes generales \\(C_1\\)\n\n\n\n\n\nDiseñoT²F_calculadoF_críticoDecisiónDiseño factorial 2²0.270.092.61No se rechaza H₀Diseño factorial 2³2.670.892.61No se rechaza H₀Diseño factorial 2⁴2.210.742.61No se rechaza H₀Diseño factorial 2⁵4.961.652.61No se rechaza H₀\n\n\n\nTabla 4.5\n\n\n\n\n\n\n4.5.3 Matriz de contrastes generales de interés \\(C_2\\)\n\n\n\n\n\nDiseñoT²F_calculadoF_críticoDecisiónDiseño factorial 2²4,659.311,549.992.61Se rechaza H₀Diseño factorial 2³6,901.922,296.042.61Se rechaza H₀Diseño factorial 2⁴10,795.483,591.292.61Se rechaza H₀Diseño factorial 2⁵19,226.236,395.912.61Se rechaza H₀\n\n\n\nTabla 4.6\n\n\n\n\nDado que, al evaluar la matriz de contrastes, se rechazó la hipótesis nula, es decir, al menos hay uno de los contrastes que es diferente de 0, resulta necesario analizar cada contraste de manera individual, obteniéndose los siguientes resultados:\n\n4.5.3.1 Contraste \\(C_{21} =\\) (-1, -1, 1, 1)\n\n\n\n\n\nDiseñoT²F_calculadoF_críticoDecisiónDiseño factorial 2²0.100.032.61No se rechaza H₀Diseño factorial 2³0.200.072.61No se rechaza H₀Diseño factorial 2⁴2.130.712.61No se rechaza H₀Diseño factorial 2⁵1.160.382.61No se rechaza H₀\n\n\n\nTabla 4.7\n\n\n\n\n\n\n4.5.3.2 Contraste \\(C_{22} =\\) (-1, 1, 1, 1)\n\n\n\n\n\nDiseñoT²F_calculadoF_críticoDecisiónDiseño factorial 2²2,525.00839.982.61Se rechaza H₀Diseño factorial 2³2,661.76885.482.61Se rechaza H₀Diseño factorial 2⁴2,063.87686.582.61Se rechaza H₀Diseño factorial 2⁵2,022.54672.832.61Se rechaza H₀\n\n\n\nTabla 4.8\n\n\n\n\n\n\n4.5.3.3 Contraste \\(C_{23} =\\) (1, -1, 0, 0)\n\n\n\n\n\nDiseñoT²F_calculadoF_críticoDecisiónDiseño factorial 2²0.060.022.61No se rechaza H₀Diseño factorial 2³0.170.062.61No se rechaza H₀Diseño factorial 2⁴1.680.562.61No se rechaza H₀Diseño factorial 2⁵2.750.922.61No se rechaza H₀\n\n\n\nTabla 4.9\n\n\n\n\n\n\n\n\nDı́az Monroy, Luis Guillermo, y Rivera Morales Mario Alfonso. 2012. Análisis estadı́stico de datos multivariados. Universidad Nacional de Colombia.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-22",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-22",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "3.1 Diseño \\(2^2\\)",
    "text": "3.1 Diseño \\(2^2\\)\n\n3.1.1 Significancia de los efectos\n\n\nCódigo\n# Matrices\nTAB1_22 &lt;- matrix(0, nrow = n, ncol = 3)\nTAB2_22 &lt;- matrix(0, nrow = n, ncol = 3)\nTAB3_22 &lt;- matrix(0, nrow = n, ncol = 3)\nTAB4_22 &lt;- matrix(0, nrow = n, ncol = 3)\nTAB6_22 &lt;- matrix(0, nrow = n, ncol = 3)\nefectos_reales_22 &lt;- matrix(NA, nrow = n, ncol = 3)\n\nnames_22 &lt;- c(\"A\",\"B\", \"A:B\")\ncolnames(TAB1_22) &lt;- names_22\ncolnames(TAB2_22) &lt;- names_22\ncolnames(TAB3_22) &lt;- names_22\ncolnames(TAB4_22) &lt;- names_22\ncolnames(TAB6_22) &lt;- names_22\ncolnames(efectos_reales_22) &lt;- names_22\n\n# Tabla para completar los errores\nECM_tab_22 &lt;- data.frame(       \n    dis1_22 = numeric(n),\n    dis2_22 = numeric(n),\n    dis3_22 = numeric(n),\n    dis4_22 = numeric(n))\n\n# Bucle principal\nset.seed(3)\nfor(i in seq_len(n)){\n  ## Efectos a evaluar en el este diseño\n  todos_efectos_22 &lt;- c(\"A\", \"B\", \"A:B\")\n  \n  # Selección de un número aleatorio entre 1 y 3\n  # dado que existen 3 efectos posibles a evaluar en este diseño.\n  n_ef &lt;- sample(0:length(todos_efectos_22), 1)\n  \n  # Elección aleatoria _n_ef_ efectos que serán los efectos significativos\n  efectos_activos &lt;- sample(todos_efectos_22, n_ef)\n  efectos_reales_22_vec &lt;- setNames(rep(0, length(todos_efectos_22)), todos_efectos_22)\n  \n  # Asignación de un valor aleatorio a los efectos elegidos como significativos:\n  efectos_reales_22_vec[efectos_activos] &lt;- sample(c(runif(n_ef, -7, -0.5), \n                                                  runif(n_ef,  0.5, 7)),n_ef)\n  \n  # Guardar efectos reales como 1/0\n  efectos_reales_22[i,] &lt;- c(\n    as.integer(efectos_reales_22_vec[\"A\"]   != 0),\n    as.integer(efectos_reales_22_vec[\"B\"]   != 0),\n    as.integer(efectos_reales_22_vec[\"A:B\"]  != 0))\n  \n  # Generar respuesta\n  \n  ## Diseño con réplicas y con 5 puntos centrales\n \n  dis1_cod &lt;- data.frame(\n    A = c(rep(c(-1,1),2), rep(c(-1,1),2), rep(0,5)),\n    B = c(rep(c(rep(-1,2), rep(1,2)), 2), rep(0,5)))\n \n  n_corridas &lt;- nrow(dis1_cod)\n  \n  ## Generación del error\n  error &lt;- rnorm(n_corridas, 0, 2)               #error ~ (mu = 0, sigma^2 = 2^2)\n  \n  ## Generación de la respuesta\n  yrta &lt;- 50 +\n    efectos_reales_22_vec[\"A\"]   * dis1_cod$A +\n    efectos_reales_22_vec[\"B\"]   * dis1_cod$B +\n    efectos_reales_22_vec[\"A:B\"]  * dis1_cod$A * dis1_cod$B +\n    error\n  \n  ## Asignación de la respuesta al dis1_cod\n  dis1_cod &lt;- cbind(dis1_cod, yrta)\n \n  ## Diseño con réplicas y sin puntos centrales\n  \n  dis2_cod &lt;- dis1_cod[-c(9:13),]\n  \n  ## Diseño sin réplica y con cinco puntos centrales\n  rep1 &lt;- c(1:4)\n  rep2 &lt;- c(5:8)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis3_cod &lt;- dis1_cod[-sel,]      \n  \n  ## Diseño sin réplica y con dos puntos centrales\n  rep1 &lt;- c(1:4)\n  rep2 &lt;- c(5:8)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  rep_pc &lt;- sample(c(9:13),3)                    #punto central a eliminar\n  \n  dis4_cod &lt;- dis1_cod[-c(sel,rep_pc),]     \n  \n  ## Diseño sin réplica y sin puntos centrales\n  rep1 &lt;- c(1:4, 9:13)\n  rep2 &lt;- c(5:8, 9:13)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis6_cod &lt;- dis1_cod[-sel,] \n  \n  mod6 &lt;- lm(yrta~A*B, data=dis6_cod)\n  \n  graf &lt;- suppressMessages(halfnormal(mod6, alpha = 0.05, plot=FALSE, method=\"Lenth\"))\n  signif &lt;- graf$signif\n  TAB6_22[i, todos_efectos_22 %in% signif] &lt;- 1\n  \n  # Modelo\n  ## Evaluación del diseño con réplicas y con cinco puntos centrales\n  mod1 &lt;- lm(yrta~A*B, data=dis1_cod) \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  mod2 &lt;- lm(yrta~A*B, data=dis2_cod)  \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  mod3 &lt;- lm(yrta~A*B, data=dis3_cod)  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  mod4 &lt;- lm(yrta~A*B, data=dis4_cod)  \n \n  ## Almacenar los ECM\n  ECM_tab_22$dis1_22[i] &lt;- (deviance(mod1) / df.residual(mod1))\n  ECM_tab_22$dis2_22[i] &lt;- (deviance(mod2) / df.residual(mod2))\n  ECM_tab_22$dis3_22[i] &lt;- (deviance(mod3) / df.residual(mod3))\n  ECM_tab_22$dis4_22[i] &lt;- (deviance(mod4) / df.residual(mod4))\n  \n  # Lista de modelos y de tablas\n  mods &lt;- list(mod1, mod2, mod3, mod4)\n  tabs &lt;- list(TAB1_22, TAB2_22, TAB3_22, TAB4_22)\n\n  for (j in seq_along(mods)) {\n    tabs[[j]][i, ] &lt;- sapply(1:3, function(k) {\n    as.integer(anova(mods[[j]])[k, 5] &lt;= 0.05) })}\n  \n  ## Evaluación del diseño con réplicas y con cinco puntos centrales\n  TAB1_22 &lt;- tabs[[1]] \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  TAB2_22 &lt;- tabs[[2]] \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  TAB3_22 &lt;- tabs[[3]]  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  TAB4_22 &lt;- tabs[[4]]}  \n\n\n\n\n3.1.2 Potencia y error tipo I\n\n\nCódigo\n## Evaluación del diseño con réplicas y con cinco puntos centrales\ncomp1_22 &lt;- round(colSums(efectos_reales_22 == TAB1_22) / n * 100, 2)\npot1_22 &lt;- round(colSums((efectos_reales_22 == 1) & (TAB1_22 == 1)) /\n                colSums(efectos_reales_22 == 1) * 100, 2)\nerr1_22 &lt;- round(colSums((efectos_reales_22 == 0) & (TAB1_22 == 1)) /\n                colSums(efectos_reales_22 == 0) * 100, 2)\n\n## Evaluación del diseño con réplicas y sin puntos centrales\ncomp2_22 &lt;- round(colSums(efectos_reales_22 == TAB2_22) / n * 100, 2)\npot2_22 &lt;- round(colSums((efectos_reales_22 == 1) & (TAB2_22 == 1)) / \n                colSums(efectos_reales_22 == 1) * 100, 2)\nerr2_22 &lt;- round(colSums((efectos_reales_22 == 0) & (TAB2_22 == 1)) / \n                colSums(efectos_reales_22 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con cinco puntos centrales\ncomp3_22 &lt;- round(colSums(efectos_reales_22 == TAB3_22) / n * 100, 2)\npot3_22 &lt;- round(colSums((efectos_reales_22 == 1) & (TAB3_22 == 1)) / \n                colSums(efectos_reales_22 == 1) * 100, 2)\nerr3_22 &lt;- round(colSums((efectos_reales_22 == 0) & (TAB3_22 == 1)) / \n                colSums(efectos_reales_22 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con dos puntos centrales\ncomp4_22 &lt;- round(colSums(efectos_reales_22 == TAB4_22) / n * 100, 2)\npot4_22 &lt;- round(colSums((efectos_reales_22 == 1) & (TAB4_22 == 1)) / \n                colSums(efectos_reales_22 == 1) * 100, 2)\nerr4_22 &lt;- round(colSums((efectos_reales_22 == 0) & (TAB4_22 == 1)) / \n                colSums(efectos_reales_22 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplica y sin puntos centrales\ncomp6_22 &lt;- round(colSums(efectos_reales_22 == TAB6_22) / n * 100, 2)\npot6_22 &lt;- round(colSums((efectos_reales_22 == 1) & (TAB6_22 == 1)) /\n                colSums(efectos_reales_22 == 1) * 100, 2)\nerr6_22 &lt;- round(colSums((efectos_reales_22 == 0) & (TAB6_22 == 1)) /\n                colSums(efectos_reales_22 == 0) * 100, 2)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-23",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-23",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "3.2 Diseño \\(2^3\\)",
    "text": "3.2 Diseño \\(2^3\\)\n\n3.2.1 Significancia de los efectos\n\n\nCódigo\n# Matrices\nTAB1_23 &lt;- matrix(0, nrow = n, ncol = 7)\nTAB2_23 &lt;- matrix(0, nrow = n, ncol = 7)\nTAB3_23 &lt;- matrix(0, nrow = n, ncol = 7)\nTAB4_23 &lt;- matrix(0, nrow = n, ncol = 7)\nTAB6_23 &lt;- matrix(0, nrow = n, ncol = 7)\nefectos_reales_23 &lt;- matrix(0, nrow = n, ncol = 7)\n\nnames_23 &lt;- c(\"A\",\"B\",\"C\",\"A:B\",\"A:C\",\"B:C\",\"A:B:C\")\ncolnames(TAB1_23) &lt;- names_23\ncolnames(TAB2_23) &lt;- names_23\ncolnames(TAB3_23) &lt;- names_23\ncolnames(TAB4_23) &lt;- names_23\ncolnames(TAB6_23) &lt;- names_23\ncolnames(efectos_reales_23) &lt;- names_23\n\n# Tabla para completar los errores\nECM_tab_23 &lt;- data.frame(       \n    dis1_23 = numeric(n),\n    dis2_23 = numeric(n),\n    dis3_23 = numeric(n),\n    dis4_23 = numeric(n))\n\n# Bucle principal\nset.seed(3)\nfor(i in seq_len(n)){\n  ## Efectos a evaluar en el este diseño\n  todos_efectos_23 &lt;- c(\"A\",\"B\",\"C\",\"A:B\",\"A:C\",\"B:C\",\"A:B:C\")\n  \n  # Selección de un número aleatorio entre 1 y 7\n  # dado que existen 7 efectos posibles a evaluar en este diseño.\n  n_ef &lt;- sample(0:length(todos_efectos_23), 1)\n  \n  # Elección aleatoria _n_ef_ efectos que serán los efectos significativos\n  efectos_activos &lt;- sample(todos_efectos_23, n_ef)\n  efectos_reales_23_vec &lt;- setNames(rep(0, length(todos_efectos_23)), todos_efectos_23)\n  \n  # Asignación de un valor aleatorio a los efectos elegidos como significativos:\n  efectos_reales_23_vec[efectos_activos] &lt;- sample(c(runif(n_ef, -7, -0.5), \n                                                  runif(n_ef,  0.5, 7)),n_ef)\n  \n  # Guardar efectos reales como 1/0\n  efectos_reales_23[i,] &lt;- c(\n    as.integer(efectos_reales_23_vec[\"A\"]     != 0),\n    as.integer(efectos_reales_23_vec[\"B\"]     != 0),\n    as.integer(efectos_reales_23_vec[\"C\"]     != 0),\n    as.integer(efectos_reales_23_vec[\"A:B\"]   != 0),\n    as.integer(efectos_reales_23_vec[\"A:C\"]   != 0),\n    as.integer(efectos_reales_23_vec[\"B:C\"]   != 0),\n    as.integer(efectos_reales_23_vec[\"A:B:C\"] != 0))\n  \n  # Generar respuesta\n  \n  ## Diseño de variables codificadas con réplicas y con 5 puntos centrales\n \n  dis1_cod &lt;- data.frame(\n    A = c(rep(c(-1,1),4), rep(c(-1,1),4), rep(0,5)),\n    B = c(rep(c(rep(-1,2), rep(1,2)), 4), rep(0,5)),\n    C = c(rep(-1,4), rep(1,4), rep(-1,4), rep(1,4), rep(0,5)))\n \n  n_corridas &lt;- nrow(dis1_cod)\n  \n  ## Generación del error\n  error &lt;- rnorm(n_corridas, 0, 2)       #error ~ (mu = 0, sigma^2 = 2^2)\n  \n  ## Generación de la respuesta\n  yrta &lt;- 50 +\n    efectos_reales_23_vec[\"A\"]     * dis1_cod$A +\n    efectos_reales_23_vec[\"B\"]     * dis1_cod$B +\n    efectos_reales_23_vec[\"C\"]     * dis1_cod$C +\n    efectos_reales_23_vec[\"A:B\"]   * dis1_cod$A * dis1_cod$B +\n    efectos_reales_23_vec[\"A:C\"]   * dis1_cod$A * dis1_cod$C +\n    efectos_reales_23_vec[\"B:C\"]   * dis1_cod$B * dis1_cod$C +\n    efectos_reales_23_vec[\"A:B:C\"] * dis1_cod$A * dis1_cod$B * dis1_cod$C +\n    error\n  \n  ## Asignación de la respuesta al dis1_cod\n  dis1_cod &lt;- cbind(dis1_cod, yrta)\n \n  ## Diseño con réplicas y sin puntos centrales\n  \n  dis2_cod &lt;- dis1_cod[-c(17:21),]\n  \n  ## Diseño sin réplica y con cinco puntos centrales\n  rep1 &lt;- c(1:8)\n  rep2 &lt;- c(9:16)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis3_cod &lt;- dis1_cod[-sel,]      \n  \n  ## Diseño sin réplica y con dos puntos centrales\n  rep1 &lt;- c(1:8)\n  rep2 &lt;- c(9:16)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  rep_pc &lt;- sample(c(17:21),3)                   #punto central a eliminar\n  \n  dis4_cod &lt;- dis1_cod[-c(sel,rep_pc),]     \n  \n  ## Diseño sin réplica y sin puntos centrales\n  rep1 &lt;- c(1:8, 17:21)\n  rep2 &lt;- c(9:16, 17:21)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis6_cod &lt;- dis1_cod[-sel,] \n  \n  mod6 &lt;- lm(yrta~A*B*C, data=dis6_cod)\n  \n  graf &lt;- suppressMessages(halfnormal(mod6, alpha = 0.05, plot=FALSE, method=\"Lenth\"))\n  signif &lt;- graf$signif\n  TAB6_23[i, todos_efectos_23 %in% signif] &lt;- 1\n\n  # Modelo\n  ## Evaluación del diseño con réplicas y con cinco puntos centrales\n  mod1 &lt;- lm(yrta~A*B*C, data=dis1_cod)  \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  mod2 &lt;- lm(yrta~A*B*C, data=dis2_cod)  \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  mod3 &lt;- lm(yrta~A*B*C, data=dis3_cod)  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  mod4 &lt;- lm(yrta~A*B*C, data=dis4_cod)  \n \n  ## Almacenar los ECM\n  ECM_tab_23$dis1_23[i] &lt;- (deviance(mod1) / df.residual(mod1))\n  ECM_tab_23$dis2_23[i] &lt;- (deviance(mod2) / df.residual(mod2))\n  ECM_tab_23$dis3_23[i] &lt;- (deviance(mod3) / df.residual(mod3))\n  ECM_tab_23$dis4_23[i] &lt;- (deviance(mod4) / df.residual(mod4))\n  \n  # Lista de modelos y de tablas\n  mods &lt;- list(mod1, mod2, mod3, mod4)\n  tabs &lt;- list(TAB1_23, TAB2_23, TAB3_23, TAB4_23)\n\n  for (j in seq_along(mods)) {\n    tabs[[j]][i, ] &lt;- sapply(1:7, function(k) {\n    as.integer(anova(mods[[j]])[k, 5] &lt;= 0.05) })}\n  \n  ## Evaluación del diseño con réplicas y con cinco puntos centrales\n  TAB1_23 &lt;- tabs[[1]] \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  TAB2_23 &lt;- tabs[[2]] \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  TAB3_23 &lt;- tabs[[3]]  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  TAB4_23 &lt;- tabs[[4]]}  \n\n\n\n\n3.2.2 Potencia y error tipo I\n\n\nCódigo\n## Evaluación del diseño con réplicas y con cinco puntos centrales\ncomp1_23 &lt;- round(colSums(efectos_reales_23 == TAB1_23) / n * 100, 2)\npot1_23 &lt;- round(colSums((efectos_reales_23 == 1) & (TAB1_23 == 1)) /\n                colSums(efectos_reales_23 == 1) * 100, 2)\nerr1_23 &lt;- round(colSums((efectos_reales_23 == 0) & (TAB1_23 == 1)) /\n                colSums(efectos_reales_23 == 0) * 100, 2)\n\n## Evaluación del diseño con réplicas y sin puntos centrales\ncomp2_23 &lt;- round(colSums(efectos_reales_23 == TAB2_23) / n * 100, 2)\npot2_23 &lt;- round(colSums((efectos_reales_23 == 1) & (TAB2_23 == 1)) / \n                colSums(efectos_reales_23 == 1) * 100, 2)\nerr2_23 &lt;- round(colSums((efectos_reales_23 == 0) & (TAB2_23 == 1)) / \n                colSums(efectos_reales_23 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con cinco puntos centrales\ncomp3_23 &lt;- round(colSums(efectos_reales_23 == TAB3_23) / n * 100, 2)\npot3_23 &lt;- round(colSums((efectos_reales_23 == 1) & (TAB3_23 == 1)) / \n                colSums(efectos_reales_23 == 1) * 100, 2)\nerr3_23 &lt;- round(colSums((efectos_reales_23 == 0) & (TAB3_23 == 1)) / \n                colSums(efectos_reales_23 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con dos puntos centrales\ncomp4_23 &lt;- round(colSums(efectos_reales_23 == TAB4_23) / n * 100, 2)\npot4_23 &lt;- round(colSums((efectos_reales_23 == 1) & (TAB4_23 == 1)) / \n                colSums(efectos_reales_23 == 1) * 100, 2)\nerr4_23 &lt;- round(colSums((efectos_reales_23 == 0) & (TAB4_23 == 1)) / \n                colSums(efectos_reales_23 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y sin puntos centrales\ncomp6_23 &lt;- round(colSums(efectos_reales_23 == TAB6_23) / n * 100, 2)\npot6_23 &lt;- round(colSums((efectos_reales_23 == 1) & (TAB6_23 == 1)) /\n                colSums(efectos_reales_23 == 1) * 100, 2)\nerr6_23 &lt;- round(colSums((efectos_reales_23 == 0) & (TAB6_23 == 1)) /\n                colSums(efectos_reales_23 == 0) * 100, 2)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-24",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-24",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "3.3 Diseño \\(2^4\\)",
    "text": "3.3 Diseño \\(2^4\\)\n\n3.3.1 Significancia de los efectos\n\n\nCódigo\n# Matrices\nTAB1_24 &lt;- matrix(0, nrow = n, ncol = 15)\nTAB2_24 &lt;- matrix(0, nrow = n, ncol = 15)\nTAB3_24 &lt;- matrix(0, nrow = n, ncol = 15)\nTAB4_24 &lt;- matrix(0, nrow = n, ncol = 15)\nTAB6_24 &lt;- matrix(0, nrow = n, ncol = 15)\nefectos_reales_24 &lt;- matrix(0, nrow = n, ncol = 15)\n\nnames_24 &lt;- c(\"A\", \"B\", \"C\", \"D\",\n  \"A:B\", \"A:C\", \"B:C\", \"A:D\", \"B:D\", \"C:D\",\n  \"A:B:C\", \"A:B:D\", \"A:C:D\", \"B:C:D\",\n  \"A:B:C:D\")\n\ncolnames(TAB1_24) &lt;- names_24\ncolnames(TAB2_24) &lt;- names_24\ncolnames(TAB3_24) &lt;- names_24\ncolnames(TAB4_24) &lt;- names_24\ncolnames(TAB6_24) &lt;- names_24\ncolnames(efectos_reales_24) &lt;- names_24\n\n# Tabla para completar los errores\nECM_tab_24 &lt;- data.frame(       \n    dis1_24 = numeric(n),\n    dis2_24 = numeric(n),\n    dis3_24 = numeric(n),\n    dis4_24 = numeric(n))\n\n# Bucle principal\nset.seed(3)\nfor(i in seq_len(n)){\n  ## Efectos a evaluar en el este diseño\n  todos_efectos_24 &lt;- c(\"A\", \"B\", \"C\", \"D\",\n  \"A:B\", \"A:C\", \"B:C\", \"A:D\", \"B:D\", \"C:D\",\n  \"A:B:C\", \"A:B:D\", \"A:C:D\", \"B:C:D\",\n  \"A:B:C:D\")\n  \n  # Selección de un número aleatorio entre 1 y 15\n  # dado que existen 15 efectos posibles a evaluar en este diseño.\n  n_ef &lt;- sample(0:length(todos_efectos_24), 1)\n  \n  # Elección aleatoria _n_ef_ efectos que serán los efectos significativos\n  efectos_activos &lt;- sample(todos_efectos_24, n_ef)\n  efectos_reales_24_vec &lt;- setNames(rep(0, length(todos_efectos_24)), todos_efectos_24)\n  \n  # Asignación de un valor aleatorio a los efectos elegidos como significativos:\n  efectos_reales_24_vec[efectos_activos] &lt;- sample(c(runif(n_ef, -7, -0.5), \n                                                  runif(n_ef,  0.5, 7)),n_ef)\n  \n  # Guardar efectos reales como 1/0\n  efectos_reales_24[i, ] &lt;- c(\n    as.integer(efectos_reales_24_vec[\"A\"]       != 0),\n    as.integer(efectos_reales_24_vec[\"B\"]       != 0),\n    as.integer(efectos_reales_24_vec[\"C\"]       != 0),\n    as.integer(efectos_reales_24_vec[\"D\"]       != 0),\n    as.integer(efectos_reales_24_vec[\"A:B\"]     != 0),\n    as.integer(efectos_reales_24_vec[\"A:C\"]     != 0),\n    as.integer(efectos_reales_24_vec[\"B:C\"]     != 0),\n    as.integer(efectos_reales_24_vec[\"A:D\"]     != 0),\n    as.integer(efectos_reales_24_vec[\"B:D\"]     != 0),\n    as.integer(efectos_reales_24_vec[\"C:D\"]     != 0),\n    as.integer(efectos_reales_24_vec[\"A:B:C\"]   != 0),\n    as.integer(efectos_reales_24_vec[\"A:B:D\"]   != 0),\n    as.integer(efectos_reales_24_vec[\"A:C:D\"]   != 0),\n    as.integer(efectos_reales_24_vec[\"B:C:D\"]   != 0),\n    as.integer(efectos_reales_24_vec[\"A:B:C:D\"] != 0))\n    \n  # Generar respuesta\n  \n  ## Diseño de variables codificadas con réplicas y con 5 puntos centrales\n \n  dis1_cod &lt;- data.frame(\n      A = c(rep(c(-1,1), 8), rep(c(-1,1), 8), rep(0,5)),\n      B = c(rep(c(rep(-1,2), rep(1,2)), 4),\n            rep(c(rep(-1,2), rep(1,2)), 4),\n            rep(0,5)),\n      C = c(rep(c(rep(-1,4), rep(1,4)), 2),\n            rep(c(rep(-1,4), rep(1,4)), 2),\n            rep(0,5)),\n      D = c(rep(-1,8), rep(1,8),\n            rep(-1,8), rep(1,8),\n            rep(0,5)))\n \n  n_corridas &lt;- nrow(dis1_cod)\n  \n  ## Generación del error\n  error &lt;- rnorm(n_corridas, 0, 2)       #error ~ (mu = 0, sigma^2 = 2^2)\n  \n  ## Generación de la respuesta\n  yrta &lt;- 50 +\n  efectos_reales_24_vec[\"A\"]       * dis1_cod$A +\n  efectos_reales_24_vec[\"B\"]       * dis1_cod$B +\n  efectos_reales_24_vec[\"C\"]       * dis1_cod$C +\n  efectos_reales_24_vec[\"D\"]       * dis1_cod$D +\n  efectos_reales_24_vec[\"A:B\"]     * dis1_cod$A * dis1_cod$B +\n  efectos_reales_24_vec[\"A:C\"]     * dis1_cod$A * dis1_cod$C +\n  efectos_reales_24_vec[\"B:C\"]     * dis1_cod$B * dis1_cod$C +\n  efectos_reales_24_vec[\"A:D\"]     * dis1_cod$A * dis1_cod$D +\n  efectos_reales_24_vec[\"B:D\"]     * dis1_cod$B * dis1_cod$D +\n  efectos_reales_24_vec[\"C:D\"]     * dis1_cod$C * dis1_cod$D +\n  efectos_reales_24_vec[\"A:B:C\"]   * dis1_cod$A * dis1_cod$B * dis1_cod$C +\n  efectos_reales_24_vec[\"A:B:D\"]   * dis1_cod$A * dis1_cod$B * dis1_cod$D +\n  efectos_reales_24_vec[\"A:C:D\"]   * dis1_cod$A * dis1_cod$C * dis1_cod$D +\n  efectos_reales_24_vec[\"B:C:D\"]   * dis1_cod$B * dis1_cod$C * dis1_cod$D +\n  efectos_reales_24_vec[\"A:B:C:D\"] * dis1_cod$A * dis1_cod$B * dis1_cod$C * dis1_cod$D +\n  error\n  \n  ## Asignación de la respuesta al dis1_cod\n  dis1_cod &lt;- cbind(dis1_cod, yrta)\n \n  ## Diseño con réplicas y sin puntos centrales\n  \n  dis2_cod &lt;- dis1_cod[-c(33:37),]\n  \n  ## Diseño sin réplica y con cinco puntos centrales\n  rep1 &lt;- c(1:16)\n  rep2 &lt;- c(17:32)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis3_cod &lt;- dis1_cod[-sel,]      \n  \n  ## Diseño sin réplica y con dos puntos centrales\n  rep1 &lt;- c(1:16)\n  rep2 &lt;- c(17:32)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  rep_pc &lt;- sample(c(33:37),3)                   #punto central a eliminar\n  \n  dis4_cod &lt;- dis1_cod[-c(sel,rep_pc),]     \n  \n  ## Diseño sin réplica y sin puntos centrales\n  rep1 &lt;- c(1:16, 33:37)\n  rep2 &lt;- c(17:32, 33:37)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis6_cod &lt;- dis1_cod[-sel,] \n  \n  mod6 &lt;- lm(yrta~A*B*C*D, data=dis6_cod)\n  \n  graf &lt;- suppressMessages(halfnormal(mod6, alpha = 0.05, plot=FALSE, method=\"Lenth\"))\n  signif &lt;- graf$signif\n  TAB6_24[i, todos_efectos_24 %in% signif] &lt;- 1\n  \n  # Modelo\n  ## Evaluación del diseño con réplicas y con cinco puntos centrales\n  mod1 &lt;- lm(yrta~A*B*C*D, data=dis1_cod)  \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  mod2 &lt;- lm(yrta~A*B*C*D, data=dis2_cod)  \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  mod3 &lt;- lm(yrta~A*B*C*D, data=dis3_cod)  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  mod4 &lt;- lm(yrta~A*B*C*D, data=dis4_cod)  \n  ## Almacenar los ECM\n  ECM_tab_24$dis1_24[i] &lt;- (deviance(mod1) / df.residual(mod1))\n  ECM_tab_24$dis2_24[i] &lt;- (deviance(mod2) / df.residual(mod2))\n  ECM_tab_24$dis3_24[i] &lt;- (deviance(mod3) / df.residual(mod3))\n  ECM_tab_24$dis4_24[i] &lt;- (deviance(mod4) / df.residual(mod4))\n  \n  # Lista de modelos y de tablas\n  mods &lt;- list(mod1, mod2, mod3, mod4)\n  tabs &lt;- list(TAB1_24, TAB2_24, TAB3_24, TAB4_24)\n\n  for (j in seq_along(mods)) {\n    tabs[[j]][i, ] &lt;- sapply(1:15, function(k) {\n      as.integer(anova(mods[[j]])[k, 5] &lt;= 0.05) })}\n  \n  ## Diseño con réplicas y con cinco puntos centrales\n  TAB1_24 &lt;- tabs[[1]] \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  TAB2_24 &lt;- tabs[[2]] \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  TAB3_24 &lt;- tabs[[3]]  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  TAB4_24 &lt;- tabs[[4]]}  \n\n\n\n\n3.3.2 Potencia y error tipo I\n\n\nCódigo\n## Evaluación del diseño con réplicas y con cinco puntos centrales\ncomp1_24 &lt;- round(colSums(efectos_reales_24 == TAB1_24) / n * 100, 2)\npot1_24 &lt;- round(colSums((efectos_reales_24 == 1) & (TAB1_24 == 1)) /\n                colSums(efectos_reales_24 == 1) * 100, 2)\nerr1_24 &lt;- round(colSums((efectos_reales_24 == 0) & (TAB1_24 == 1)) /\n                colSums(efectos_reales_24 == 0) * 100, 2)\n\n## Evaluación del diseño con réplicas y sin puntos centrales\ncomp2_24 &lt;- round(colSums(efectos_reales_24 == TAB2_24) / n * 100, 2)\npot2_24 &lt;- round(colSums((efectos_reales_24 == 1) & (TAB2_24 == 1)) / \n                colSums(efectos_reales_24 == 1) * 100, 2)\nerr2_24 &lt;- round(colSums((efectos_reales_24 == 0) & (TAB2_24 == 1)) / \n                colSums(efectos_reales_24 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con cinco puntos centrales\ncomp3_24 &lt;- round(colSums(efectos_reales_24 == TAB3_24) / n * 100, 2)\npot3_24 &lt;- round(colSums((efectos_reales_24 == 1) & (TAB3_24 == 1)) / \n                colSums(efectos_reales_24 == 1) * 100, 2)\nerr3_24 &lt;- round(colSums((efectos_reales_24 == 0) & (TAB3_24 == 1)) / \n                colSums(efectos_reales_24 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con dos puntos centrales\ncomp4_24 &lt;- round(colSums(efectos_reales_24 == TAB4_24) / n * 100, 2)\npot4_24 &lt;- round(colSums((efectos_reales_24 == 1) & (TAB4_24 == 1)) / \n                colSums(efectos_reales_24 == 1) * 100, 2)\nerr4_24 &lt;- round(colSums((efectos_reales_24 == 0) & (TAB4_24 == 1)) / \n                colSums(efectos_reales_24 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y sin puntos centrales\ncomp6_24 &lt;- round(colSums(efectos_reales_24 == TAB6_24) / n * 100, 2)\npot6_24 &lt;- round(colSums((efectos_reales_24 == 1) & (TAB6_24 == 1)) /\n                colSums(efectos_reales_24 == 1) * 100, 2)\nerr6_24 &lt;- round(colSums((efectos_reales_24 == 0) & (TAB6_24 == 1)) /\n                colSums(efectos_reales_24 == 0) * 100, 2)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-25",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-25",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "3.4 Diseño \\(2^5\\)",
    "text": "3.4 Diseño \\(2^5\\)\n\n3.4.1 Significancia de los efectos\n\n\nCódigo\n# Matrices\nTAB1_25 &lt;- matrix(NA, nrow = n, ncol = 31)\nTAB2_25 &lt;- matrix(NA, nrow = n, ncol = 31)\nTAB3_25 &lt;- matrix(NA, nrow = n, ncol = 31)\nTAB4_25 &lt;- matrix(NA, nrow = n, ncol = 31)\nTAB6_25 &lt;- matrix(0, nrow = n, ncol = 31)\nefectos_reales_25 &lt;- matrix(0, nrow = n, ncol = 31)\n\nnames_25 &lt;- c(\"A\",\"B\",\"C\",\"D\",\"E\", \n           \"A:B\",\"A:C\",\"B:C\",\"A:D\",\"B:D\",\"C:D\",\"A:E\",\"B:E\",\"C:E\",\"D:E\",\n           \"A:B:C\",\"A:B:D\",\"A:C:D\",\"B:C:D\",\"A:B:E\",\"A:C:E\",\"B:C:E\",\"A:D:E\",\"B:D:E\",\"C:D:E\",\n           \"A:B:C:D\",\"A:B:C:E\",\"A:B:D:E\",\"A:C:D:E\",\"B:C:D:E\",\n           \"A:B:C:D:E\")\n\ncolnames(TAB1_25) &lt;- names_25\ncolnames(TAB2_25) &lt;- names_25\ncolnames(TAB3_25) &lt;- names_25\ncolnames(TAB4_25) &lt;- names_25\ncolnames(TAB6_25) &lt;- names_25\ncolnames(efectos_reales_25) &lt;- names_25\n\n# Tabla para completar los errores\nECM_tab_25 &lt;- data.frame(       \n    dis1_25 = numeric(n),\n    dis2_25 = numeric(n),\n    dis3_25 = numeric(n),\n    dis4_25 = numeric(n))\n\n# Bucle principal\nset.seed(3)\nfor(i in seq_len(n)){\n  ## Efectos a evaluar en el este diseño\n  todos_efectos_25 &lt;- c(\"A\",\"B\",\"C\",\"D\",\"E\", \n           \"A:B\",\"A:C\",\"B:C\",\"A:D\",\"B:D\",\"C:D\",\"A:E\",\"B:E\",\"C:E\",\"D:E\",\n           \"A:B:C\",\"A:B:D\",\"A:C:D\",\"B:C:D\",\"A:B:E\",\"A:C:E\",\"B:C:E\",\"A:D:E\",\"B:D:E\",\"C:D:E\",\n           \"A:B:C:D\",\"A:B:C:E\",\"A:B:D:E\",\"A:C:D:E\",\"B:C:D:E\",\n           \"A:B:C:D:E\")\n  \n  # Selección de un número aleatorio entre 1 y 31\n  # dado que existen 31 efectos posibles a evaluar en este diseño.\n  n_ef &lt;- sample(0:length(todos_efectos_25), 1)\n  \n  # Elección aleatoria _n_ef_ efectos que serán los efectos significativos\n  efectos_activos &lt;- sample(todos_efectos_25, n_ef)\n  efectos_reales_25_vec &lt;- setNames(rep(0, length(todos_efectos_25)), todos_efectos_25)\n  \n  # Asignación de un valor aleatorio a los efectos elegidos como significativos:\n  efectos_reales_25_vec[efectos_activos] &lt;- sample(c(runif(n_ef, -7, -0.5), \n                                                  runif(n_ef,  0.5, 7)),n_ef)\n  \n  # Guardar efectos reales como 1/0\n  efectos_reales_25[i, ] &lt;- c(\n    as.integer(efectos_reales_25_vec[\"A\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"B\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"C\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"D\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"E\"]    != 0),\n    \n    as.integer(efectos_reales_25_vec[\"A:B\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"A:C\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"B:C\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"A:D\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"B:D\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"C:D\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"A:E\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"B:E\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"C:E\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"D:E\"]   != 0),\n    \n    as.integer(efectos_reales_25_vec[\"A:B:C\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"A:B:D\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"A:C:D\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"B:C:D\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"A:B:E\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"A:C:E\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"B:C:E\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"A:D:E\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"B:D:E\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"C:D:E\"]    != 0),\n    \n    as.integer(efectos_reales_25_vec[\"A:B:C:D\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"A:B:C:E\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"A:B:D:E\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"A:C:D:E\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"B:C:D:E\"]  != 0),\n    \n    as.integer(efectos_reales_25_vec[\"A:B:C:D:E\"]!= 0))\n    \n  # Generar respuesta\n  \n  ## Diseño de variables codificadas con réplicas y con 5 puntos centrales\n \n  dis1_cod &lt;- data.frame(\n  A = c(rep(c(-1,1),16), rep(c(-1,1),16), rep(0,5)),\n  B = c(rep(c(rep(-1,2), rep(1,2)),8),  rep(c(rep(-1,2), rep(1,2)),8),rep(0,5)),\n  C = c(rep(c(rep(-1,4), rep(1,4)),4), rep(c(rep(-1,4), rep(1,4)),4),rep(0,5)),\n  D = c(rep(c(rep(-1,8), rep(1,8)),2), rep(c(rep(-1,8), rep(1,8)),2),rep(0,5)),\n  E = c(rep(-1,16), rep(1,16), rep(-1,16), rep(1,16), rep(0,5)))\n \n  n_corridas &lt;- nrow(dis1_cod)\n  \n  ## Generación del error\n  error &lt;- rnorm(n_corridas, 0, 2)       #error ~ (mu = 0, sigma^2 = 2^2)\n  \n  ## Generación de la respuesta\n  yrta &lt;- 50 +\n  efectos_reales_25_vec[\"A\"]     * dis1_cod$A +\n  efectos_reales_25_vec[\"B\"]     * dis1_cod$B +\n  efectos_reales_25_vec[\"C\"]     * dis1_cod$C +\n  efectos_reales_25_vec[\"D\"]     * dis1_cod$D +\n  efectos_reales_25_vec[\"E\"]     * dis1_cod$E +\n  \n  efectos_reales_25_vec[\"A:B\"]    * dis1_cod$A * dis1_cod$B +\n  efectos_reales_25_vec[\"A:C\"]    * dis1_cod$A * dis1_cod$C +\n  efectos_reales_25_vec[\"B:C\"]    * dis1_cod$B * dis1_cod$C +\n  efectos_reales_25_vec[\"A:D\"]    * dis1_cod$A * dis1_cod$D +\n  efectos_reales_25_vec[\"B:D\"]    * dis1_cod$B * dis1_cod$D +\n  efectos_reales_25_vec[\"C:D\"]    * dis1_cod$C * dis1_cod$D +\n  efectos_reales_25_vec[\"A:E\"]    * dis1_cod$A * dis1_cod$E +\n  efectos_reales_25_vec[\"B:E\"]    * dis1_cod$B * dis1_cod$E +\n  efectos_reales_25_vec[\"C:E\"]    * dis1_cod$C * dis1_cod$E +\n  efectos_reales_25_vec[\"D:E\"]    * dis1_cod$D * dis1_cod$E +\n  \n  efectos_reales_25_vec[\"A:B:C\"]   * dis1_cod$A * dis1_cod$B * dis1_cod$C +\n  efectos_reales_25_vec[\"A:B:D\"]   * dis1_cod$A * dis1_cod$B * dis1_cod$D +\n  efectos_reales_25_vec[\"A:C:D\"]   * dis1_cod$A * dis1_cod$C * dis1_cod$D +\n  efectos_reales_25_vec[\"B:C:D\"]   * dis1_cod$B * dis1_cod$C * dis1_cod$D +\n  efectos_reales_25_vec[\"A:B:E\"]   * dis1_cod$A * dis1_cod$B * dis1_cod$E +\n  efectos_reales_25_vec[\"A:C:E\"]   * dis1_cod$A * dis1_cod$C * dis1_cod$E +\n  efectos_reales_25_vec[\"B:C:E\"]   * dis1_cod$B * dis1_cod$C * dis1_cod$E +\n  efectos_reales_25_vec[\"A:D:E\"]   * dis1_cod$A * dis1_cod$D * dis1_cod$E +\n  efectos_reales_25_vec[\"B:D:E\"]   * dis1_cod$B * dis1_cod$D * dis1_cod$E +\n  efectos_reales_25_vec[\"C:D:E\"]   * dis1_cod$C * dis1_cod$D * dis1_cod$E +\n  \n  efectos_reales_25_vec[\"A:B:C:D\"]  * dis1_cod$A * dis1_cod$B * dis1_cod$C * dis1_cod$D +\n  efectos_reales_25_vec[\"A:B:C:E\"]  * dis1_cod$A * dis1_cod$B * dis1_cod$C * dis1_cod$E +\n  efectos_reales_25_vec[\"A:B:D:E\"]  * dis1_cod$A * dis1_cod$B * dis1_cod$D * dis1_cod$E +\n  efectos_reales_25_vec[\"A:C:D:E\"]  * dis1_cod$A * dis1_cod$C * dis1_cod$D * dis1_cod$E +\n  efectos_reales_25_vec[\"B:C:D:E\"]  * dis1_cod$B * dis1_cod$C * dis1_cod$D * dis1_cod$E +\n  \n  efectos_reales_25_vec[\"A:B:C:D:E\"] * dis1_cod$A * dis1_cod$B * dis1_cod$C * dis1_cod$D * dis1_cod$E +\n  \n  error\n  \n  ## Asignación de la respuesta al dis1_cod\n  dis1_cod &lt;- cbind(dis1_cod, yrta)\n \n  ## Diseño con réplicas y sin puntos centrales\n  \n  dis2_cod &lt;- dis1_cod[-c(65:69),]\n  \n  ## Diseño sin réplica y con cinco puntos centrales\n  rep1 &lt;- c(1:32)\n  rep2 &lt;- c(33:64)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis3_cod &lt;- dis1_cod[-sel,]      \n  \n  ## Diseño sin réplica y con dos puntos centrales\n  rep1 &lt;- c(1:32)\n  rep2 &lt;- c(33:64)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  rep_pc &lt;- sample(c(65:69),3)                   #punto central a eliminar\n  \n  dis4_cod &lt;- dis1_cod[-c(sel,rep_pc),]     \n  \n  ## Diseño sin réplicas y sin puntos centrales\n  rep1 &lt;- c(1:32, 65:69)\n  rep2 &lt;- c(33:64, 65:69)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n\n  dis6_cod &lt;- dis1_cod[-sel,] \n  \n  mod6 &lt;- lm(yrta~A*B*C*D*E, data=dis6_cod)\n  \n  graf &lt;- suppressMessages(halfnormal(mod6, alpha = 0.05, plot=FALSE, method=\"Lenth\"))\n  signif &lt;- graf$signif\n  TAB6_25[i, todos_efectos_25 %in% signif] &lt;- 1\n  \n  # Modelo\n  ## Evaluación del diseño con réplicas y con cinco puntos centrales\n  mod1 &lt;- lm(yrta~A*B*C*D*E, data=dis1_cod)  \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  mod2 &lt;- lm(yrta~A*B*C*D*E, data=dis2_cod)  \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  mod3 &lt;- lm(yrta~A*B*C*D*E, data=dis3_cod)  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  mod4 &lt;- lm(yrta~A*B*C*D*E, data=dis4_cod)  \n  ## Almacenar los ECM\n  ECM_tab_25$dis1_25[i] &lt;- (deviance(mod1) / df.residual(mod1))\n  ECM_tab_25$dis2_25[i] &lt;- (deviance(mod2) / df.residual(mod2))\n  ECM_tab_25$dis3_25[i] &lt;- (deviance(mod3) / df.residual(mod3))\n  ECM_tab_25$dis4_25[i] &lt;- (deviance(mod4) / df.residual(mod4))\n  \n  # Lista de modelos y de tablas\n  mods &lt;- list(mod1, mod2, mod3, mod4)\n  tabs &lt;- list(TAB1_25, TAB2_25, TAB3_25, TAB4_25)\n\n  for (j in seq_along(mods)) {\n    tabs[[j]][i, ] &lt;- sapply(1:31, function(k) {\n      as.integer(anova(mods[[j]])[k, 5] &lt;= 0.05) })}\n  \n  ## Diseño con réplicas y con cinco puntos centrales\n  TAB1_25 &lt;- tabs[[1]] \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  TAB2_25 &lt;- tabs[[2]] \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  TAB3_25 &lt;- tabs[[3]]  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  TAB4_25 &lt;- tabs[[4]]}  \n\n\n\n\n3.4.2 Potencia y error tipo I\n\n\nCódigo\n## Evaluación del diseño con réplicas y con cinco puntos centrales\ncomp1_25 &lt;- round(colSums(efectos_reales_25 == TAB1_25) / n * 100, 2)\npot1_25 &lt;- round(colSums((efectos_reales_25 == 1) & (TAB1_25 == 1)) /\n                colSums(efectos_reales_25 == 1) * 100, 2)\nerr1_25 &lt;- round(colSums((efectos_reales_25 == 0) & (TAB1_25 == 1)) /\n                colSums(efectos_reales_25 == 0) * 100, 2)\n\n## Evaluación del diseño con réplicas y sin puntos centrales\ncomp2_25 &lt;- round(colSums(efectos_reales_25 == TAB2_25) / n * 100, 2)\npot2_25 &lt;- round(colSums((efectos_reales_25 == 1) & (TAB2_25 == 1)) / \n                colSums(efectos_reales_25 == 1) * 100, 2)\nerr2_25 &lt;- round(colSums((efectos_reales_25 == 0) & (TAB2_25 == 1)) / \n                colSums(efectos_reales_25 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con cinco puntos centrales\ncomp3_25 &lt;- round(colSums(efectos_reales_25 == TAB3_25) / n * 100, 2)\npot3_25 &lt;- round(colSums((efectos_reales_25 == 1) & (TAB3_25 == 1)) / \n                colSums(efectos_reales_25 == 1) * 100, 2)\nerr3_25 &lt;- round(colSums((efectos_reales_25 == 0) & (TAB3_25 == 1)) / \n                colSums(efectos_reales_25 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con dos puntos centrales\ncomp4_25 &lt;- round(colSums(efectos_reales_25 == TAB4_25) / n * 100, 2)\npot4_25 &lt;- round(colSums((efectos_reales_25 == 1) & (TAB4_25 == 1)) / \n                colSums(efectos_reales_25 == 1) * 100, 2)\nerr4_25 &lt;- round(colSums((efectos_reales_25 == 0) & (TAB4_25 == 1)) / \n                colSums(efectos_reales_25 == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y sin puntos centrales\ncomp6_25 &lt;- round(colSums(efectos_reales_25 == TAB6_25) / n * 100, 2)\npot6_25 &lt;- round(colSums((efectos_reales_25 == 1) & (TAB6_25 == 1)) /\n                colSums(efectos_reales_25 == 1) * 100, 2)\nerr6_25 &lt;- round(colSums((efectos_reales_25 == 0) & (TAB6_25 == 1)) /\n                colSums(efectos_reales_25 == 0) * 100, 2)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-22-1",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-22-1",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "4.1 Diseño \\(2^2\\)",
    "text": "4.1 Diseño \\(2^2\\)\n\n\n\n\n\nFactoresCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas sin puntos centrales (Lenth)Sin réplicas sin puntos centrales (Lenth)Sin réplicas sin puntos centrales (Lenth)ConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IA89.783.033.7689.180.812.7782.970.715.1575.053.944.3651.21.620.20B88.882.884.7986.979.625.2182.570.003.9672.651.925.0048.61.730.62A:B89.382.974.3987.680.164.9981.368.746.1972.248.504.1950.30.600.20\n\n\n\nTabla 4.1: Concordancia porcentual en la significancia de los efectos según réplicas y puntos centrales en el diseño experimental 2²\n\n\n\n\n\n\n\n\n\n\n\n\nFigura 4.1",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-23-1",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-23-1",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "4.2 Diseño \\(2^3\\)",
    "text": "4.2 Diseño \\(2^3\\)\n\n\n\n\n\nFactoresCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas sin puntos centrales (Lenth)Sin réplicas sin puntos centrales (Lenth)Sin réplicas sin puntos centrales (Lenth)ConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IA93.691.704.7292.890.004.7287.379.155.4780.263.625.0960.017.452.26B93.290.874.3392.990.294.3386.980.976.8081.368.545.1558.221.362.68C92.690.425.2192.890.224.6187.882.046.4181.869.065.4159.722.553.01A:B92.990.494.7492.889.684.1587.079.555.7381.969.435.9360.623.082.77A:C92.590.275.0492.289.504.8386.379.396.0979.064.314.8357.321.373.15B:C93.991.153.5092.889.514.0987.980.044.6779.264.406.8159.419.753.11A:B:C93.792.995.5994.292.794.3989.985.175.3983.672.144.9961.225.853.59\n\n\n\nTabla 4.2: Concordancia porcentual en la significancia de los efectos según réplicas y puntos centrales en el diseño experimental 2³\n\n\n\n\n\n\n\n\n\n\n\n\nFigura 4.2",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-24-1",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-24-1",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "4.3 Diseño \\(2^4\\)",
    "text": "4.3 Diseño \\(2^4\\)\n\n\n\n\n\nFactoresCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas sin puntos centrales (Lenth)Sin réplicas sin puntos centrales (Lenth)Sin réplicas sin puntos centrales (Lenth)ConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IA94.694.134.9494.293.935.5391.787.454.1587.379.765.3462.125.512.17B95.395.474.8895.495.875.0891.187.605.2885.676.975.4961.627.172.85C95.396.525.8795.096.326.2692.888.553.1385.276.486.4661.925.152.94D94.594.495.4994.594.695.6989.884.845.0884.573.233.8660.624.412.03A:B95.094.964.9694.894.564.9691.588.105.1685.575.004.1762.627.022.38A:C94.894.815.2194.995.005.2191.386.733.7583.072.886.0460.226.152.92B:C94.893.543.9694.693.133.9691.085.453.5685.475.965.3562.125.662.18A:D94.192.874.5794.292.493.9590.384.593.5383.773.605.4159.224.663.53B:D97.597.052.0397.097.053.0592.790.164.6786.778.154.4761.426.182.24C:D96.496.613.8495.995.864.0591.287.574.6985.877.975.3360.027.312.99A:B:C95.396.866.3194.796.467.1391.588.415.3087.580.355.0961.929.274.28A:B:D94.894.985.3894.594.785.7891.788.154.7886.778.314.9860.022.893.19A:C:D95.395.835.2495.895.834.2392.388.894.2388.281.354.8462.027.583.02B:C:D94.594.645.6594.294.646.2591.488.295.4486.077.985.8561.927.383.02A:B:C:D94.595.306.3494.094.916.9591.186.694.2985.475.934.7061.827.592.45\n\n\n\nTabla 4.3: Concordancia porcentual en la significancia de los efectos según réplicas y puntos centrales en el diseño experimental 2⁴\n\n\n\n\n\n\n\n\n\n\n\n\nFigura 4.3",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-25-1",
    "href": "01_dis_factoriales/compilado_factoriales_completos_vfinal.html#diseño-25-1",
    "title": "1  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos \\(2^k\\)",
    "section": "4.4 Diseño \\(2^5\\)",
    "text": "4.4 Diseño \\(2^5\\)\n\n\n\n\n\nFactoresCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas sin puntos centrales (Lenth)Sin réplicas sin puntos centrales (Lenth)Sin réplicas sin puntos centrales (Lenth)ConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IA96.297.244.8796.297.044.6792.590.935.8889.884.815.0763.030.183.25B97.099.205.1796.798.795.3794.093.365.3790.987.936.1664.131.393.58C97.198.584.3597.298.584.1594.693.724.5590.187.046.9263.730.163.56D97.098.844.9697.298.844.5594.393.805.1791.187.795.3762.831.013.31E97.098.624.6797.498.623.8594.493.895.0790.085.405.2763.831.362.84A:B96.797.644.2896.897.844.2895.093.713.6789.585.466.3164.532.422.24A:C96.897.974.5897.098.524.7994.494.095.2389.886.886.7564.135.492.18B:C96.398.285.8796.097.906.0895.094.073.9891.387.955.0362.932.703.98A:D96.998.004.2096.898.204.6094.693.804.6089.686.207.0064.431.602.80B:D97.499.244.6697.299.435.3095.094.704.6689.686.556.9964.134.853.18C:D96.398.846.4096.098.646.8294.293.414.9691.188.766.4063.132.564.34A:E97.498.974.0997.698.973.7094.794.034.6790.986.835.2563.828.192.53B:E96.697.874.7696.997.874.1492.991.886.0090.285.114.3565.135.012.69C:E97.999.403.6197.899.203.6195.994.813.0192.689.424.2163.929.741.80D:E96.098.256.3796.098.056.1693.992.985.1388.984.996.9863.230.602.46A:B:C96.498.025.2496.398.025.4493.993.455.6590.786.114.6463.930.362.02A:B:D96.698.014.8296.297.615.2294.092.834.8291.987.854.0263.130.283.82A:C:D96.296.664.3496.496.854.1291.990.726.7287.582.376.5162.332.653.04B:C:D96.797.894.6097.298.283.9794.293.304.8190.786.024.1861.930.083.35A:B:E97.398.393.7897.398.393.7893.592.765.7789.684.315.1765.733.802.78A:C:E97.398.433.8797.098.434.4894.794.505.0991.188.215.9162.027.502.24B:C:E96.898.254.7496.898.254.7495.194.764.5490.987.965.9864.933.982.27A:D:E96.098.046.1296.197.845.7194.092.554.4989.784.905.3163.230.392.65B:D:E96.598.595.5796.398.595.9693.891.754.1788.383.506.9664.330.992.78C:D:E96.297.785.3696.497.784.9694.792.943.5789.984.684.9664.531.252.78A:B:C:D97.599.424.5597.499.424.7596.295.543.1092.689.153.7263.531.011.86A:B:C:E96.497.604.7996.397.604.9993.792.184.7989.884.574.9965.233.072.79A:B:D:E97.299.224.9196.999.025.3295.996.284.5091.287.675.1163.732.293.48A:C:D:E97.398.504.0797.298.504.2894.192.874.5089.585.556.0063.333.773.00B:C:D:E96.297.445.0795.997.245.4893.591.914.8789.884.624.8764.032.944.06A:B:C:D:E96.898.645.1596.698.645.5795.393.793.0989.785.055.3663.531.652.68\n\n\n\nTabla 4.4: Concordancia porcentual en la significancia de los efectos según réplicas y puntos centrales en el diseño experimental 2⁵\n\n\n\n\n\n\n\n\n\n\n\n\nFigura 4.4",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales completos $2^k$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html",
    "href": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html",
    "title": "2  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales \\(2^{k-p}\\)",
    "section": "",
    "text": "3 Metodología",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales $2^{k-p}$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#evaluación-de-la-significancia-de-los-efectos",
    "href": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#evaluación-de-la-significancia-de-los-efectos",
    "title": "2  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales \\(2^{k-p}\\)",
    "section": "3.1 Evaluación de la significancia de los efectos",
    "text": "3.1 Evaluación de la significancia de los efectos\nEl presente estudio tiene como propósito analizar el impacto de eliminar réplicas o los puntos centrales en un diseño factorial fraccional \\(2^{k-p}\\) sobre la significancia estadística de los efectos principales e interacciones, así como sobre el error cuadrático medio (ECM). Para este fin se realizaron 1000 simulaciones independientes, y en cada simulación se generó un caso particular de efectos activos y su correspondiente respuesta (Ver Metodología aquí).\nA partir del diseño factorial completo \\(2^k\\) con dos réplicas y cinco puntos centrales (dis0_cod) con respuesta asignada, se eliminaron las filas correspondientes para obtener un diseño fraccional \\(2^{k-p}\\) que conserva las dos réplicas y los cinco puntos centrales (dis1_cod). Adicionalmente, se generaron tres variantes eliminando aleatoriamente filas de réplicas o puntos centrales: un diseño con réplicas pero sin puntos centrales (dis2_cod), un diseño sin réplicas con cinco puntos centrales (dis3_cod) y un diseño sin réplicas con únicamente dos puntos centrales (dis4_cod).\nPara cada diseño se ajusta el modelo aditivo y se calcula el ANOVA correspondiente. Los resultados de significancia de los efectos se almacenan en las tablas TAB1, TAB2, TAB3 y TAB4, donde el valor 1 indica significancia estadística (\\(p &lt; 0.05\\)) y 0 indica no significancia. Este procedimiento se implementa evaluando, en cada fila del ANOVA, si el valor \\(p\\) es menor o igual a 0.05, transformando el resultado lógico en un valor entero.\nA partir de estas tablas se calcula el porcentaje de concordancia entre los efectos reales y los detectados por cada modelo, la potencia (proporción de efectos verdaderamente significativos correctamente identificados) y el error tipo I (proporción de efectos nulos detectados como significativos).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales $2^{k-p}$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#evaluación-del-ecm-con-medidas-repetidas",
    "href": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#evaluación-del-ecm-con-medidas-repetidas",
    "title": "2  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales \\(2^{k-p}\\)",
    "section": "3.2 Evaluación del ECM con medidas repetidas",
    "text": "3.2 Evaluación del ECM con medidas repetidas\nCon relación a la evaluación del ECM, se utiliza la metodología de medidas repetidas, en la cual a una misma unidad experimental se le aplican sucesivamente varios tratamientos, generando valores repetidos de la respuesta sobre el mismo individuo (Dı́az Monroy y Mario Alfonso (2012)).\nEn este estudio, a partir de los diseños simulados en la sección anterior, cada fila corresponde a la simulación del diseño experimental de referencia (dis1_cod), al que se le generan variantes al eliminar réplicas o puntos centrales (dis2_cod, dis3_cod, dis4_cod). Para cada diseño se obtiene como variable respuesta el Error Cuadrático Medio (ECM), calculado mediante la siguiente fórmula:\n\\[\n\\text{ECM} = \\frac{\\text{deviance}(modelo)}{\\text{grados de libertad del residual}(modelo)}.\n\\]\nEstos resultados fueron compilados en la matriz ECM_tab, que corresponde a la matriz \\(X = (x_{ij})\\), donde \\(x_{ij}\\) representa la respuesta del \\(i\\)-ésimo sujeto al \\(j\\)-ésimo tratamiento. Incialmente, se realiza un análisis descriptivo de los ECM (Ver Figura 5.1). Luego, se construye la matriz de contrastes \\(C\\), donde cada fila representa una hipótesis a evaluar. En este caso, se plantea la utilización de una matriz de contrastes \\(C_1\\) cuyo objetivo es contrastar simultáneamente todas las medias de los tratamientos. Con ello, se busca determinar si existe al menos un tratamiento que difiera significativamente de los demás, lo que constituye el análogo a la prueba ANOVA clásica, pero en un contexto donde los tratamientos son dependientes.\n\\[\nC_1 =\n\\begin{bmatrix}\n-1 & -1 &  0 &  0 \\\\\n0 & -1 &  1 &  0 \\\\\n0 &  0 & -1 &  1\n\\end{bmatrix}\n\\]\nAsimismo, es posible considerar una matriz de contrastes generales de interés \\(C_2\\), tales como:\n\\[\nC_2 =\n\\begin{bmatrix}\n-1 & -1 &  1 &  1 \\\\\n-1 &  1 &  1 &  1 \\\\\n1 & -1 &  0 &  0\n\\end{bmatrix}\n\\]\nDonde los contrastes a evaluar son:\nContraste 1: Contraste que relaciona los diseños con réplica con respecto a los diseños sin réplica \\(C_1 =\\) (-1, -1, 1, 1)\nContraste 2: Contraste que relaciona el diseño con réplica y 5 puntos centrales frente al conjunto de variantes derivadas del mismo \\(C_2 =\\) (-1, 1, 1, 1)\nContraste 3: Contraste que relaciona el impacto de la réplica en diseños con la misma cantidad de puntos centrales \\(C_3 =\\) (1, -1, 0, 0)\nLa matriz \\(C\\) se utiliza para transformar los datos: \\(Y = CX\\). De esta forma, el problema se reduce a \\((p-1)\\) dimensiones y se trabaja con contrastes independientes, evitando dependencia entre medias y permitiendo aplicar la prueba \\(T^2\\) de Hotelling.\nEl cálculo implementado en el código sigue la formulación teórica:\n\\[\nT^2 = n(C \\overline{X})' (CSC')^{-1} (C \\overline{X}),\n\\]\ndonde \\(n\\) es el número de simulaciones y \\(S\\) la matriz de covarianzas estimada mediante\n\\[\nS = \\frac{1}{n-1}X'(I - \\tfrac{1}{n}\\mathbf{1}\\mathbf{1}')X.\n\\]\nLa decisión es rechazar \\(H_0\\) si, para un nivel de significancia \\(\\alpha = 0.05\\),\n\\[\nF = \\frac{n - p + 1}{(n-1)(p-1)} T^2 &gt; F_{(\\alpha, p-1, n-p+1)}\n\\]",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales $2^{k-p}$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#diseño-23-1",
    "href": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#diseño-23-1",
    "title": "2  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales \\(2^{k-p}\\)",
    "section": "4.1 Diseño \\(2^{3-1}\\)",
    "text": "4.1 Diseño \\(2^{3-1}\\)\n\n4.1.1 Significancia de los efectos\n\n\nCódigo\n# Matrices\nTAB1_23 &lt;- matrix(0, nrow = n, ncol = 3)\nTAB2_23 &lt;- matrix(0, nrow = n, ncol = 3)\nTAB3_23 &lt;- matrix(0, nrow = n, ncol = 3)\nTAB4_23 &lt;- matrix(0, nrow = n, ncol = 3)\nefectos_reales_23 &lt;- matrix(0, nrow = n, ncol = 7)\n\nnames_23 &lt;- c(\"Ap\",\"Bp\",\"Cp\")   # Los que serán estimados por el modelo\ncolnames(TAB1_23) &lt;- names_23\ncolnames(TAB2_23) &lt;- names_23\ncolnames(TAB3_23) &lt;- names_23\ncolnames(TAB4_23) &lt;- names_23\ncolnames(efectos_reales_23) &lt;- c(\"A\",\"B\",\"C\",\"AB\",\"AC\",\"BC\",\"ABC\")  # Todos\n\n# Tabla para completar los errores\nECM_tab_23 &lt;- data.frame(       \n    dis1 = numeric(n),\n    dis2 = numeric(n),\n    dis3 = numeric(n),\n    dis4 = numeric(n))\n\n# Bucle principal\nset.seed(3)\nfor(i in seq_len(n)){\n  ## Efectos a evaluar en el este diseño\n  todos_efectos_23 &lt;- c(\"A\",\"B\",\"C\",\"AB\",\"AC\",\"BC\",\"ABC\")  #Todos\n  \n  # Selección de un número aleatorio entre 1 y 7\n  # dado que existen 7 efectos posibles a evaluar en este diseño.\n  n_ef &lt;- sample(0:length(todos_efectos_23), 1)\n  \n  # Elección aleatoria _n_ef_ efectos que serán los efectos significativos\n  efectos_activos &lt;- sample(todos_efectos_23, n_ef)\n  efectos_reales_23_vec &lt;- setNames(rep(0, length(todos_efectos_23)), todos_efectos_23)\n  \n  # Asignación de un valor aleatorio a los efectos elegidos como significativos:\n  efectos_reales_23_vec[efectos_activos] &lt;- sample(c(runif(n_ef, -7, -0.5), \n                                                  runif(n_ef,  0.5, 7)), n_ef)\n  \n  # Guardar efectos reales como 1/0\n  efectos_reales_23[i,] &lt;- c(\n    as.integer(efectos_reales_23_vec[\"A\"]   != 0),\n    as.integer(efectos_reales_23_vec[\"B\"]   != 0),\n    as.integer(efectos_reales_23_vec[\"C\"]   != 0),\n    as.integer(efectos_reales_23_vec[\"AB\"]  != 0),\n    as.integer(efectos_reales_23_vec[\"AC\"]  != 0),\n    as.integer(efectos_reales_23_vec[\"BC\"]  != 0),\n    as.integer(efectos_reales_23_vec[\"ABC\"] != 0))\n  \n  # Generar respuesta\n  \n  ## Diseño factorial completo con réplicas y con 5 puntos centrales\n \n  dis0_cod &lt;- data.frame(\n    A = c(rep(c(-1,1),4), rep(c(-1,1),4), rep(0,5)),\n    B = c(rep(c(rep(-1,2), rep(1,2)), 4), rep(0,5)),\n    C = c(rep(-1,4), rep(1,4), rep(-1,4), rep(1,4), rep(0,5)))\n \n  n_corridas &lt;- nrow(dis0_cod)\n  \n  ## Generación del error\n  error &lt;- rnorm(n_corridas, 0, 2)       #error ~ (mu = 0, sigma^2 = 2^2)\n  \n  ## Generación de la respuesta\n  yrta &lt;- 50 +\n    efectos_reales_23_vec[\"A\"]   * dis0_cod$A +\n    efectos_reales_23_vec[\"B\"]   * dis0_cod$B +\n    efectos_reales_23_vec[\"C\"]   * dis0_cod$C +\n    efectos_reales_23_vec[\"AB\"]  * dis0_cod$A * dis0_cod$B +\n    efectos_reales_23_vec[\"AC\"]  * dis0_cod$A * dis0_cod$C +\n    efectos_reales_23_vec[\"BC\"]  * dis0_cod$B * dis0_cod$C +\n    efectos_reales_23_vec[\"ABC\"] * dis0_cod$A * dis0_cod$B * dis0_cod$C +\n    error\n  \n  ## Asignación de la respuesta al dis0_cod \n  ## (Diseño factorial completo con réplicas y con 5 puntos centrales)\n  dis0_cod &lt;- cbind(dis0_cod, yrta)\n \n  ## Diseño fraccional con réplicas y puntos centrales\n  dis1_cod &lt;- dis0_cod[c(2,3,5,8,10,11,13,16,17:21),]\n  \n  ## Diseño fraccional con réplicas y sin puntos centrales\n  dis2_cod &lt;- dis0_cod[c(2,3,5,8,10,11,13,16),]\n  \n  ## Diseño fraccional sin réplica y con cinco puntos centrales\n  rep1 &lt;- c(9:16,1,4,6,7)      #filas que deben ser eliminadas en \"sel\"\n  rep2 &lt;- c(1:8,9,12,14,15)    #filas que deben ser eliminadas en \"sel\"\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis3_cod &lt;- dis0_cod[-sel,]      \n  \n  ## Diseño fraccional sin réplica y con dos puntos centrales\n  rep1 &lt;- c(9:16,1,4,6,7)      #filas que deben ser eliminadas en \"sel\"\n  rep2 &lt;- c(1:8,9,12,14,15)    #filas que deben ser eliminadas en \"sel\"\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  rep_pc &lt;- sample(c(17:21),3)                   #punto central a eliminar\n  \n  dis4_cod &lt;- dis0_cod[-c(sel,rep_pc),]     \n  \n  # Modelo\n  ## Evaluación del diseño con réplicas y con cinco puntos centrales\n  mod1 &lt;- lm(yrta~A+B+C, data=dis1_cod)  \n  \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  mod2 &lt;- lm(yrta~A+B+C, data=dis2_cod)  \n  \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  mod3 &lt;- lm(yrta~A+B+C, data=dis3_cod)  \n  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  mod4 &lt;- lm(yrta~A+B+C, data=dis4_cod)  \n  \n  ## Almacenar los ECM\n  ECM_tab_23$dis1[i] &lt;- (deviance(mod1) / df.residual(mod1))\n  ECM_tab_23$dis2[i] &lt;- (deviance(mod2) / df.residual(mod2))\n  ECM_tab_23$dis3[i] &lt;- (deviance(mod3) / df.residual(mod3))\n  ECM_tab_23$dis4[i] &lt;- (deviance(mod4) / df.residual(mod4))\n  \n  # Lista de modelos y de tablas\n  mods &lt;- list(mod1, mod2, mod3, mod4)\n  tabs &lt;- list(TAB1_23, TAB2_23, TAB3_23, TAB4_23)\n\n  for (j in seq_along(mods)) {\n    tabs[[j]][i, ] &lt;- sapply(1:3, function(k) {\n    as.integer(anova(mods[[j]])[k, 5] &lt;= 0.05) })}\n  \n  ## Evaluación del diseño con réplicas y con cinco puntos centrales\n  TAB1_23 &lt;- tabs[[1]] \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  TAB2_23 &lt;- tabs[[2]] \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  TAB3_23 &lt;- tabs[[3]]  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  TAB4_23 &lt;- tabs[[4]]}  \n\n\n\n\n4.1.2 Potencia y error tipo I\n\n\nCódigo\n## Evaluación del diseño con réplicas y con cinco puntos centrales\ncomp1_23 &lt;- round(colSums(efectos_reales_23[,1:3] == TAB1_23) / n * 100, 2)\npot1_23 &lt;- round(colSums((efectos_reales_23[,1:3] == 1) & (TAB1_23 == 1)) /\n                colSums(efectos_reales_23[,1:3] == 1) * 100, 2)\nerr1_23 &lt;- round(colSums((efectos_reales_23[,1:3] == 0) & (TAB1_23 == 1)) /\n                colSums(efectos_reales_23[,1:3] == 0) * 100, 2)\n\n## Evaluación del diseño con réplicas y sin puntos centrales\ncomp2_23 &lt;- round(colSums(efectos_reales_23[,1:3] == TAB2_23) / n * 100, 2)\npot2_23 &lt;- round(colSums((efectos_reales_23[,1:3] == 1) & (TAB2_23 == 1)) / \n                colSums(efectos_reales_23[,1:3] == 1) * 100, 2)\nerr2_23 &lt;- round(colSums((efectos_reales_23[,1:3] == 0) & (TAB2_23 == 1)) / \n                colSums(efectos_reales_23[,1:3] == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con cinco puntos centrales\ncomp3_23 &lt;- round(colSums(efectos_reales_23[,1:3] == TAB3_23) / n * 100, 2)\npot3_23 &lt;- round(colSums((efectos_reales_23[,1:3] == 1) & (TAB3_23 == 1)) / \n                colSums(efectos_reales_23[,1:3] == 1) * 100, 2)\nerr3_23 &lt;- round(colSums((efectos_reales_23[,1:3] == 0) & (TAB3_23 == 1)) / \n                colSums(efectos_reales_23[,1:3] == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con dos puntos centrales\ncomp4_23 &lt;- round(colSums(efectos_reales_23[,1:3] == TAB4_23) / n * 100, 2)\npot4_23 &lt;- round(colSums((efectos_reales_23[,1:3] == 1) & (TAB4_23 == 1)) / \n                colSums(efectos_reales_23[,1:3] == 1) * 100, 2)\nerr4_23 &lt;- round(colSums((efectos_reales_23[,1:3] == 0) & (TAB4_23 == 1)) / \n                colSums(efectos_reales_23[,1:3] == 0) * 100, 2)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales $2^{k-p}$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#diseño-24-1",
    "href": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#diseño-24-1",
    "title": "2  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales \\(2^{k-p}\\)",
    "section": "4.2 Diseño \\(2^{4-1}\\)",
    "text": "4.2 Diseño \\(2^{4-1}\\)\n\n4.2.1 Significancia de los efectos\n\n\nCódigo\n# Matrices\nTAB1_24 &lt;- matrix(0, nrow = n, ncol = 4)\nTAB2_24 &lt;- matrix(0, nrow = n, ncol = 4)\nTAB3_24 &lt;- matrix(0, nrow = n, ncol = 4)\nTAB4_24 &lt;- matrix(0, nrow = n, ncol = 4)\nefectos_reales_24 &lt;- matrix(0, nrow = n, ncol = 15)\n\nnames_24 &lt;- c(\"Ap\", \"Bp\", \"Cp\", \"Dp\")  # Los que serán estimados por el modelo\n\ncolnames(TAB1_24) &lt;- names_24\ncolnames(TAB2_24) &lt;- names_24\ncolnames(TAB3_24) &lt;- names_24\ncolnames(TAB4_24) &lt;- names_24\n\ncolnames(efectos_reales_24) &lt;- c(\"A\", \"B\", \"C\", \"D\",    #Todos\n  \"AB\", \"AC\", \"BC\", \"AD\", \"BD\", \"CD\",\n  \"ABC\", \"ABD\", \"ACD\", \"BCD\",\n  \"ABCD\")\n\n# Tabla para completar los errores\nECM_tab_24 &lt;- data.frame(       \n    dis1 = numeric(n),\n    dis2 = numeric(n),\n    dis3 = numeric(n),\n    dis4 = numeric(n))\n\n# Bucle principal\nset.seed(3)\nfor(i in seq_len(n)){\n  ## Efectos a evaluar en el este diseño\n  todos_efectos_24 &lt;- c(\"A\", \"B\", \"C\", \"D\",\n  \"AB\", \"AC\", \"BC\", \"AD\", \"BD\", \"CD\",\n  \"ABC\", \"ABD\", \"ACD\", \"BCD\",\n  \"ABCD\")\n  \n  # Selección de un número aleatorio entre 1 y 15\n  # dado que existen 15 efectos posibles a evaluar en este diseño.\n  n_ef &lt;- sample(1:length(todos_efectos_24), 1)\n  \n  # Elección aleatoria _n_ef_ efectos que serán los efectos significativos\n  efectos_activos &lt;- sample(todos_efectos_24, n_ef)\n  efectos_reales_24_vec &lt;- setNames(rep(0, length(todos_efectos_24)), todos_efectos_24)\n  \n  # Asignación de un valor aleatorio a los efectos elegidos como significativos:\n  efectos_reales_24_vec[efectos_activos] &lt;- runif(n_ef, -7, 7)\n  \n  # Guardar efectos reales como 1/0\n  efectos_reales_24[i, ] &lt;- c(\n    as.integer(efectos_reales_24_vec[\"A\"]    != 0),\n    as.integer(efectos_reales_24_vec[\"B\"]    != 0),\n    as.integer(efectos_reales_24_vec[\"C\"]    != 0),\n    as.integer(efectos_reales_24_vec[\"D\"]    != 0),\n    as.integer(efectos_reales_24_vec[\"AB\"]   != 0),\n    as.integer(efectos_reales_24_vec[\"AC\"]   != 0),\n    as.integer(efectos_reales_24_vec[\"BC\"]   != 0),\n    as.integer(efectos_reales_24_vec[\"AD\"]   != 0),\n    as.integer(efectos_reales_24_vec[\"BD\"]   != 0),\n    as.integer(efectos_reales_24_vec[\"CD\"]   != 0),\n    as.integer(efectos_reales_24_vec[\"ABC\"]  != 0),\n    as.integer(efectos_reales_24_vec[\"ABD\"]  != 0),\n    as.integer(efectos_reales_24_vec[\"ACD\"]  != 0),\n    as.integer(efectos_reales_24_vec[\"BCD\"]  != 0),\n    as.integer(efectos_reales_24_vec[\"ABCD\"] != 0))\n    \n  # Generar respuesta\n  \n  ## Diseño factorial completo con réplicas y con 5 puntos centrales\n \n  dis0_cod &lt;- data.frame(\n      A = c(rep(c(-1,1), 8), rep(c(-1,1), 8), rep(0,5)),\n      B = c(rep(c(rep(-1,2), rep(1,2)), 4),\n            rep(c(rep(-1,2), rep(1,2)), 4),\n            rep(0,5)),\n      C = c(rep(c(rep(-1,4), rep(1,4)), 2),\n            rep(c(rep(-1,4), rep(1,4)), 2),\n            rep(0,5)),\n      D = c(rep(-1,8), rep(1,8),\n            rep(-1,8), rep(1,8),\n            rep(0,5)))\n \n  n_corridas &lt;- nrow(dis0_cod)\n  \n  ## Generación del error\n  error &lt;- rnorm(n_corridas, 0, 2)       #error ~ (mu = 0, sigma^2 = 2^2)\n  \n  ## Generación de la respuesta\n  yrta &lt;- 50 +\n  efectos_reales_24_vec[\"A\"]    * dis0_cod$A +\n  efectos_reales_24_vec[\"B\"]    * dis0_cod$B +\n  efectos_reales_24_vec[\"C\"]    * dis0_cod$C +\n  efectos_reales_24_vec[\"D\"]    * dis0_cod$D +\n  efectos_reales_24_vec[\"AB\"]   * dis0_cod$A * dis0_cod$B +\n  efectos_reales_24_vec[\"AC\"]   * dis0_cod$A * dis0_cod$C +\n  efectos_reales_24_vec[\"BC\"]   * dis0_cod$B * dis0_cod$C +\n  efectos_reales_24_vec[\"AD\"]   * dis0_cod$A * dis0_cod$D +\n  efectos_reales_24_vec[\"BD\"]   * dis0_cod$B * dis0_cod$D +\n  efectos_reales_24_vec[\"CD\"]   * dis0_cod$C * dis0_cod$D +\n  efectos_reales_24_vec[\"ABC\"]  * dis0_cod$A * dis0_cod$B * dis0_cod$C +\n  efectos_reales_24_vec[\"ABD\"]  * dis0_cod$A * dis0_cod$B * dis0_cod$D +\n  efectos_reales_24_vec[\"ACD\"]  * dis0_cod$A * dis0_cod$C * dis0_cod$D +\n  efectos_reales_24_vec[\"BCD\"]  * dis0_cod$B * dis0_cod$C * dis0_cod$D +\n  efectos_reales_24_vec[\"ABCD\"] * dis0_cod$A * dis0_cod$B * dis0_cod$C * dis0_cod$D +\n  error\n\n  ## Asignación de la respuesta al dis0_cod\n  ## (Diseño factorial completo con réplicas y con 5 puntos centrales)\n  dis0_cod &lt;- cbind(dis0_cod, yrta)\n\n  ## Diseño fraccional con réplicas y puntos centrales\n  dis1_cod &lt;- dis0_cod[c(1,4,6,7,10,11,13,16,\n                         17,20,22,23,26,27,29,32,\n                         33:37),]\n  \n  ## Diseño con réplicas y sin puntos centrales\n  \n  dis2_cod &lt;- dis0_cod[c(1,4,6,7,10,11,13,16,\n                         17,20,22,23,26,27,29,32),]\n  \n  ## Diseño sin réplica y con cinco puntos centrales\n  rep1 &lt;- c(17:32,2,3,5,8,9,12,14,15)       #filas para eliminar en \"sel\"\n  rep2 &lt;- c(1:16,18,19,21,24,25,28,30,31)   #filas para eliminar en \"sel\"\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis3_cod &lt;- dis0_cod[-sel,]      \n  \n  ## Diseño sin réplica y con dos puntos centrales\n  rep1 &lt;- c(17:32,2,3,5,8,9,12,14,15)       #filas para eliminar en \"sel\"\n  rep2 &lt;- c(1:16,18,19,21,24,25,28,30,31)   #filas para eliminar en \"sel\"\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  rep_pc &lt;- sample(c(33:37),3)                   #punto central a eliminar\n  \n  dis4_cod &lt;- dis0_cod[-c(sel,rep_pc),]     \n  \n  # Modelo\n  ## Evaluación del diseño con réplicas y con cinco puntos centrales\n  mod1 &lt;- lm(yrta ~ A + B + C + D, data=dis1_cod)  \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  mod2 &lt;- lm(yrta ~ A + B + C + D, data=dis2_cod)  \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  mod3 &lt;- lm(yrta ~ A + B + C + D, data=dis3_cod)  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  mod4 &lt;- lm(yrta ~ A + B + C + D, data=dis4_cod)  \n  \n  ## Almacenar los ECM\n  ECM_tab_24$dis1[i] &lt;- (deviance(mod1) / df.residual(mod1))\n  ECM_tab_24$dis2[i] &lt;- (deviance(mod2) / df.residual(mod2))\n  ECM_tab_24$dis3[i] &lt;- (deviance(mod3) / df.residual(mod3))\n  ECM_tab_24$dis4[i] &lt;- (deviance(mod4) / df.residual(mod4))\n  \n  # Lista de modelos y de tablas\n  mods &lt;- list(mod1, mod2, mod3, mod4)\n  tabs &lt;- list(TAB1_24, TAB2_24, TAB3_24, TAB4_24)\n\n  for (j in seq_along(mods)) {\n    tabs[[j]][i, ] &lt;- sapply(1:4, function(k) {\n      as.integer(anova(mods[[j]])[k, 5] &lt;= 0.05) })}\n  \n  ## Diseño con réplicas y con cinco puntos centrales\n  TAB1_24 &lt;- tabs[[1]] \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  TAB2_24 &lt;- tabs[[2]] \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  TAB3_24 &lt;- tabs[[3]]  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  TAB4_24 &lt;- tabs[[4]]}  \n\n\n\n\n4.2.2 Potencia y error tipo I\n\n\nCódigo\n## Evaluación del diseño con réplicas y con cinco puntos centrales\ncomp1_24 &lt;- round(colSums(efectos_reales_24[,1:4] == TAB1_24) / n * 100, 2)\npot1_24 &lt;- round(colSums((efectos_reales_24[,1:4] == 1) & (TAB1_24 == 1)) /\n                colSums(efectos_reales_24[,1:4] == 1) * 100, 2)\nerr1_24 &lt;- round(colSums((efectos_reales_24[,1:4] == 0) & (TAB1_24 == 1)) /\n                colSums(efectos_reales_24[,1:4] == 0) * 100, 2)\n\n## Evaluación del diseño con réplicas y sin puntos centrales\ncomp2_24 &lt;- round(colSums(efectos_reales_24[,1:4] == TAB2_24) / n * 100, 2)\npot2_24 &lt;- round(colSums((efectos_reales_24[,1:4] == 1) & (TAB2_24 == 1)) / \n                colSums(efectos_reales_24[,1:4] == 1) * 100, 2)\nerr2_24 &lt;- round(colSums((efectos_reales_24[,1:4] == 0) & (TAB2_24 == 1)) / \n                colSums(efectos_reales_24[,1:4] == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con cinco puntos centrales\ncomp3_24 &lt;- round(colSums(efectos_reales_24[,1:4] == TAB3_24) / n * 100, 2)\npot3_24 &lt;- round(colSums((efectos_reales_24[,1:4] == 1) & (TAB3_24 == 1)) / \n                colSums(efectos_reales_24[,1:4] == 1) * 100, 2)\nerr3_24 &lt;- round(colSums((efectos_reales_24[,1:4] == 0) & (TAB3_24 == 1)) / \n                colSums(efectos_reales_24[,1:4] == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con dos puntos centrales\ncomp4_24 &lt;- round(colSums(efectos_reales_24[,1:4] == TAB4_24) / n * 100, 2)\npot4_24 &lt;- round(colSums((efectos_reales_24[,1:4] == 1) & (TAB4_24 == 1)) / \n                colSums(efectos_reales_24[,1:4] == 1) * 100, 2)\nerr4_24 &lt;- round(colSums((efectos_reales_24[,1:4] == 0) & (TAB4_24 == 1)) / \n                colSums(efectos_reales_24[,1:4] == 0) * 100, 2)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales $2^{k-p}$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#diseño-25-2",
    "href": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#diseño-25-2",
    "title": "2  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales \\(2^{k-p}\\)",
    "section": "4.3 Diseño \\(2^{5-2}\\)",
    "text": "4.3 Diseño \\(2^{5-2}\\)\n\n4.3.1 Significancia de los efectos\n\n\nCódigo\n# Matrices\nTAB1_25 &lt;- matrix(0, nrow = n, ncol = 5)\nTAB2_25 &lt;- matrix(0, nrow = n, ncol = 5)\nTAB3_25 &lt;- matrix(0, nrow = n, ncol = 5)\nTAB4_25 &lt;- matrix(0, nrow = n, ncol = 5)\nefectos_reales_25 &lt;- matrix(0, nrow = n, ncol = 31)\n\nnames_25 &lt;- c(\"Ap\",\"Bp\",\"Cp\",\"Dp\",\"Ep\")\n\ncolnames(TAB1_25) &lt;- names_25\ncolnames(TAB2_25) &lt;- names_25\ncolnames(TAB3_25) &lt;- names_25\ncolnames(TAB4_25) &lt;- names_25\ncolnames(efectos_reales_25) &lt;- c(\"A\",\"B\",\"C\",\"D\",\"E\", \n           \"AB\",\"AC\",\"BC\",\"AD\",\"BD\",\"CD\",\"AE\",\"BE\",\"CE\",\"DE\",\n           \"ABC\",\"ABD\",\"ACD\",\"BCD\",\"ABE\",\"ACE\",\"BCE\",\"ADE\",\"BDE\",\"CDE\",\n           \"ABCD\",\"ABCE\",\"ABDE\",\"ACDE\",\"BCDE\",\n           \"ABCDE\")\n\n# Tabla para completar los errores\nECM_tab_25 &lt;- data.frame(       \n    dis1 = numeric(n),\n    dis2 = numeric(n),\n    dis3 = numeric(n),\n    dis4 = numeric(n))\n\n# Bucle principal\nset.seed(3)\nfor(i in seq_len(n)){\n  ## Efectos a evaluar en el este diseño\n  todos_efectos_25 &lt;- c(\"A\",\"B\",\"C\",\"D\",\"E\", \n           \"AB\",\"AC\",\"BC\",\"AD\",\"BD\",\"CD\",\"AE\",\"BE\",\"CE\",\"DE\",\n           \"ABC\",\"ABD\",\"ACD\",\"BCD\",\"ABE\",\"ACE\",\"BCE\",\"ADE\",\"BDE\",\"CDE\",\n           \"ABCD\",\"ABCE\",\"ABDE\",\"ACDE\",\"BCDE\",\n           \"ABCDE\")\n  \n  # Selección de un número aleatorio entre 1 y 31\n  # dado que existen 31 efectos posibles a evaluar en este diseño.\n  n_ef &lt;- sample(1:length(todos_efectos_25), 1)\n  \n  # Elección aleatoria _n_ef_ efectos que serán los efectos significativos\n  efectos_activos &lt;- sample(todos_efectos_25, n_ef)\n  efectos_reales_25_vec &lt;- setNames(rep(0, length(todos_efectos_25)), todos_efectos_25)\n  \n  # Asignación de un valor aleatorio a los efectos elegidos como significativos:\n  efectos_reales_25_vec[efectos_activos] &lt;- sample(c(runif(n_ef, -7, -0.5), \n                                                  runif(n_ef,  0.5, 7)), n_ef)\n  \n  # Guardar efectos reales como 1/0\n  efectos_reales_25[i, ] &lt;- c(\n    as.integer(efectos_reales_25_vec[\"A\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"B\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"C\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"D\"]    != 0),\n    as.integer(efectos_reales_25_vec[\"E\"]    != 0),\n    \n    as.integer(efectos_reales_25_vec[\"AB\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"AC\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"BC\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"AD\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"BD\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"CD\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"AE\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"BE\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"CE\"]   != 0),\n    as.integer(efectos_reales_25_vec[\"DE\"]   != 0),\n    \n    as.integer(efectos_reales_25_vec[\"ABC\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"ABD\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"ACD\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"BCD\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"ABE\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"ACE\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"BCE\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"ADE\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"BDE\"]  != 0),\n    as.integer(efectos_reales_25_vec[\"CDE\"]  != 0),\n    \n    as.integer(efectos_reales_25_vec[\"ABCD\"] != 0),\n    as.integer(efectos_reales_25_vec[\"ABCE\"] != 0),\n    as.integer(efectos_reales_25_vec[\"ABDE\"] != 0),\n    as.integer(efectos_reales_25_vec[\"ACDE\"] != 0),\n    as.integer(efectos_reales_25_vec[\"BCDE\"] != 0),\n    \n    as.integer(efectos_reales_25_vec[\"ABCDE\"]!= 0))\n    \n  # Generar respuesta\n  \n  ## Diseño de variables codificadas con réplicas y con 5 puntos centrales\n \n  dis0_cod &lt;- data.frame(\n  A = c(rep(c(-1,1),16), rep(c(-1,1),16), rep(0,5)),\n  B = c(rep(c(rep(-1,2), rep(1,2)),8),  rep(c(rep(-1,2), rep(1,2)),8),rep(0,5)),\n  C = c(rep(c(rep(-1,4), rep(1,4)),4), rep(c(rep(-1,4), rep(1,4)),4),rep(0,5)),\n  D = c(rep(c(rep(-1,8), rep(1,8)),2), rep(c(rep(-1,8), rep(1,8)),2),rep(0,5)),\n  E = c(rep(-1,16), rep(1,16), rep(-1,16), rep(1,16), rep(0,5)))\n \n  n_corridas &lt;- nrow(dis0_cod)\n  \n  ## Generación del error\n  error &lt;- rnorm(n_corridas, 0, 2)       #error ~ (mu = 0, sigma^2 = 2^2)\n  \n  ## Generación de la respuesta\n  yrta &lt;- 50 +\n  efectos_reales_25_vec[\"A\"]     * dis0_cod$A +\n  efectos_reales_25_vec[\"B\"]     * dis0_cod$B +\n  efectos_reales_25_vec[\"C\"]     * dis0_cod$C +\n  efectos_reales_25_vec[\"D\"]     * dis0_cod$D +\n  efectos_reales_25_vec[\"E\"]     * dis0_cod$E +\n  \n  efectos_reales_25_vec[\"AB\"]    * dis0_cod$A * dis0_cod$B +\n  efectos_reales_25_vec[\"AC\"]    * dis0_cod$A * dis0_cod$C +\n  efectos_reales_25_vec[\"BC\"]    * dis0_cod$B * dis0_cod$C +\n  efectos_reales_25_vec[\"AD\"]    * dis0_cod$A * dis0_cod$D +\n  efectos_reales_25_vec[\"BD\"]    * dis0_cod$B * dis0_cod$D +\n  efectos_reales_25_vec[\"CD\"]    * dis0_cod$C * dis0_cod$D +\n  efectos_reales_25_vec[\"AE\"]    * dis0_cod$A * dis0_cod$E +\n  efectos_reales_25_vec[\"BE\"]    * dis0_cod$B * dis0_cod$E +\n  efectos_reales_25_vec[\"CE\"]    * dis0_cod$C * dis0_cod$E +\n  efectos_reales_25_vec[\"DE\"]    * dis0_cod$D * dis0_cod$E +\n  \n  efectos_reales_25_vec[\"ABC\"]   * dis0_cod$A * dis0_cod$B * dis0_cod$C +\n  efectos_reales_25_vec[\"ABD\"]   * dis0_cod$A * dis0_cod$B * dis0_cod$D +\n  efectos_reales_25_vec[\"ACD\"]   * dis0_cod$A * dis0_cod$C * dis0_cod$D +\n  efectos_reales_25_vec[\"BCD\"]   * dis0_cod$B * dis0_cod$C * dis0_cod$D +\n  efectos_reales_25_vec[\"ABE\"]   * dis0_cod$A * dis0_cod$B * dis0_cod$E +\n  efectos_reales_25_vec[\"ACE\"]   * dis0_cod$A * dis0_cod$C * dis0_cod$E +\n  efectos_reales_25_vec[\"BCE\"]   * dis0_cod$B * dis0_cod$C * dis0_cod$E +\n  efectos_reales_25_vec[\"ADE\"]   * dis0_cod$A * dis0_cod$D * dis0_cod$E +\n  efectos_reales_25_vec[\"BDE\"]   * dis0_cod$B * dis0_cod$D * dis0_cod$E +\n  efectos_reales_25_vec[\"CDE\"]   * dis0_cod$C * dis0_cod$D * dis0_cod$E +\n  \n  efectos_reales_25_vec[\"ABCD\"]  * dis0_cod$A * dis0_cod$B * dis0_cod$C * dis0_cod$D +\n  efectos_reales_25_vec[\"ABCE\"]  * dis0_cod$A * dis0_cod$B * dis0_cod$C * dis0_cod$E +\n  efectos_reales_25_vec[\"ABDE\"]  * dis0_cod$A * dis0_cod$B * dis0_cod$D * dis0_cod$E +\n  efectos_reales_25_vec[\"ACDE\"]  * dis0_cod$A * dis0_cod$C * dis0_cod$D * dis0_cod$E +\n  efectos_reales_25_vec[\"BCDE\"]  * dis0_cod$B * dis0_cod$C * dis0_cod$D * dis0_cod$E +\n  \n  efectos_reales_25_vec[\"ABCDE\"] * dis0_cod$A * dis0_cod$B * dis0_cod$C * dis0_cod$D * dis0_cod$E +\n  \n  error\n  \n  ## Asignación de la respuesta al dis0_cod\n  dis0_cod &lt;- cbind(dis0_cod, yrta)\n\n  ## Diseño fraccional con réplicas y puntos centrales\n  dis1_cod &lt;- dis0_cod[c(2, 3, 5, 8, 9, 12, 14, 15, 17, 20, 22, 23, 26, 27, 29, 32,\n                         34, 35, 37, 40, 41, 44, 46, 47, 49, 52, 54, 55, 58, 59, 61, 64,\n                         65:69),]\n  \n  ## Diseño con réplicas y sin puntos centrales\n  dis2_cod &lt;- dis0_cod[c(2, 3, 5, 8, 9, 12, 14, 15, 17, 20, 22, 23, 26, 27, 29, 32,\n                         34, 35, 37, 40, 41, 44, 46, 47, 49, 52, 54, 55, 58, 59, 61, 64),]\n  \n  ## Diseño sin réplica y con cinco puntos centrales\n  rep1 &lt;- c(33:64, 1, 4, 6, 7, 10, 11, 13, 16, 18, 19, 21, 24, 25, 28, 30, 31)\n  rep2 &lt;- c(1:32, 33, 36, 38, 39, 42, 43, 45, 48, 50, 51, 53, 56, 57, 60, 62, 63)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  \n  dis3_cod &lt;- dis0_cod[-sel,]      \n  \n  ## Diseño sin réplica y con dos puntos centrales\n  rep1 &lt;- c(33:64, 1, 4, 6, 7, 10, 11, 13, 16, 18, 19, 21, 24, 25, 28, 30, 31)\n  rep2 &lt;- c(1:32, 33, 36, 38, 39, 42, 43, 45, 48, 50, 51, 53, 56, 57, 60, 62, 63)\n  seleccion_name &lt;- sample(c(\"rep1\",\"rep2\"),1)   #repetición a eliminar\n  sel &lt;- get(seleccion_name)\n  rep_pc &lt;- sample(c(65:69),3)                   #punto central a eliminar\n  \n  dis4_cod &lt;- dis0_cod[-c(sel,rep_pc),]     \n  \n  # Modelo\n  ## Evaluación del diseño con réplicas y con cinco puntos centrales\n  mod1 &lt;- lm(yrta ~ A + B + C + D + E, data=dis1_cod) \n\n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  mod2 &lt;- lm(yrta ~ A + B + C + D + E, data=dis2_cod)  \n  \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  mod3 &lt;- lm(yrta ~ A + B + C + D + E, data=dis3_cod)  \n  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  mod4 &lt;- lm(yrta ~ A + B + C + D + E, data=dis4_cod)  \n  \n  ## Almacenar los ECM\n  ECM_tab_25$dis1[i] &lt;- (deviance(mod1) / df.residual(mod1))\n  ECM_tab_25$dis2[i] &lt;- (deviance(mod2) / df.residual(mod2))\n  ECM_tab_25$dis3[i] &lt;- (deviance(mod3) / df.residual(mod3))\n  ECM_tab_25$dis4[i] &lt;- (deviance(mod4) / df.residual(mod4))\n  \n  # Lista de modelos y de tablas\n  mods &lt;- list(mod1, mod2, mod3, mod4)\n  tabs &lt;- list(TAB1_25, TAB2_25, TAB3_25, TAB4_25)\n\n  for (j in seq_along(mods)) {\n    tabs[[j]][i, ] &lt;- sapply(1:5, function(k) {\n      as.integer(anova(mods[[j]])[k, 5] &lt;= 0.05) })}\n  \n  ## Diseño con réplicas y con cinco puntos centrales\n  TAB1_25 &lt;- tabs[[1]] \n  ## Evaluación del diseño con réplicas y sin puntos centrales\n  TAB2_25 &lt;- tabs[[2]] \n  ## Evaluación del diseño sin réplicas y con cinco puntos centrales\n  TAB3_25 &lt;- tabs[[3]]  \n  ## Evaluación del diseño sin réplicas y con dos puntos centrales\n  TAB4_25 &lt;- tabs[[4]]}  \n\n\n\n\n4.3.2 Potencia y error tipo I\n\n\nCódigo\n## Evaluación del diseño con réplicas y con cinco puntos centrales\ncomp1_25 &lt;- round(colSums(efectos_reales_25[,c(1:5)] == TAB1_25) / n * 100, 2)\npot1_25 &lt;- round(colSums((efectos_reales_25[,c(1:5)] == 1) & (TAB1_25 == 1)) /\n                colSums(efectos_reales_25[,c(1:5)] == 1) * 100, 2)\nerr1_25 &lt;- round(colSums((efectos_reales_25[,c(1:5)] == 0) & (TAB1_25 == 1)) /\n                colSums(efectos_reales_25[,c(1:5)] == 0) * 100, 2)\n\n## Evaluación del diseño con réplicas y sin puntos centrales\ncomp2_25 &lt;- round(colSums(efectos_reales_25[,c(1:5)] == TAB2_25) / n * 100, 2)\npot2_25 &lt;- round(colSums((efectos_reales_25[,c(1:5)] == 1) & (TAB2_25 == 1)) / \n                colSums(efectos_reales_25[,c(1:5)] == 1) * 100, 2)\nerr2_25 &lt;- round(colSums((efectos_reales_25[,c(1:5)] == 0) & (TAB2_25 == 1)) / \n                colSums(efectos_reales_25[,c(1:5)] == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con cinco puntos centrales\ncomp3_25 &lt;- round(colSums(efectos_reales_25[,c(1:5)] == TAB3_25) / n * 100, 2)\npot3_25 &lt;- round(colSums((efectos_reales_25[,c(1:5)] == 1) & (TAB3_25 == 1)) / \n                colSums(efectos_reales_25[,c(1:5)] == 1) * 100, 2)\nerr3_25 &lt;- round(colSums((efectos_reales_25[,c(1:5)] == 0) & (TAB3_25 == 1)) / \n                colSums(efectos_reales_25[,c(1:5)] == 0) * 100, 2)\n\n## Evaluación del diseño sin réplicas y con dos puntos centrales\ncomp4_25 &lt;- round(colSums(efectos_reales_25[,c(1:5)] == TAB4_25) / n * 100, 2)\npot4_25 &lt;- round(colSums((efectos_reales_25[,c(1:5)] == 1) & (TAB4_25 == 1)) / \n                colSums(efectos_reales_25[,c(1:5)] == 1) * 100, 2)\nerr4_25 &lt;- round(colSums((efectos_reales_25[,c(1:5)] == 0) & (TAB4_25 == 1)) / \n                colSums(efectos_reales_25[,c(1:5)] == 0) * 100, 2)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales $2^{k-p}$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#evaluación-del-error-cuadrático-medio-ecm-por-medidas-repetidas",
    "href": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#evaluación-del-error-cuadrático-medio-ecm-por-medidas-repetidas",
    "title": "2  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales \\(2^{k-p}\\)",
    "section": "4.4 Evaluación del Error Cuadrático Medio (ECM) por medidas repetidas",
    "text": "4.4 Evaluación del Error Cuadrático Medio (ECM) por medidas repetidas\nPara la evaluación del Error Cuadrático Medio (ECM) se diseñó la siguiente función:\n\n\nCódigo\n# X: Matriz que incluye los datos para comparar que debe estar organizada así\n# C: Matriz de contrastes\n# alpha: Nivel de significancia\n\nHotelling &lt;- function(X, C, alpha) {\n  \n  ## Cálculo de la $T^2$ Hotelling\n  mu &lt;- colMeans(X)\n  n &lt;- nrow(X)   # Número de individuos (filas de X)\n  p &lt;- ncol(X)   # Número de tratamientos (columnas de X)\n  \n  # Matriz identidad e I - (1/n)11'\n  In &lt;- diag(n)\n  uno &lt;- matrix(1, n, n)   # 1 x t(1)\n  H &lt;- In - (1/n) * uno\n  \n  # Calculo de S\n  S &lt;- (1/(n-1)) * t(X) %*% H %*% X\n  \n  # Cálculo de T2\n  T2 &lt;- n*(t(C%*%mu))%*%(solve(C%*%S%*%t(C)))%*%(C%*%mu)\n  \n  # F calculado\n  Fcal &lt;- (n - p + 1) / ((n - 1)*(p - 1)) * T2\n  \n  # F tabulado (crítico)\n  gl1 &lt;- p-1\n  gl2 &lt;- n-p+1\n  \n  # Valor crítico F(0.05; p-1, n-p+1)\n  F_critico &lt;- qf(1-alpha, df1 = gl1, df2 = gl2)\n\n  return(list(\n    T2 = as.numeric(T2),\n    Fcal = as.numeric(Fcal),\n    F_critico = F_critico))\n}",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales $2^{k-p}$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#diseño-23-1-1",
    "href": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#diseño-23-1-1",
    "title": "2  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales \\(2^{k-p}\\)",
    "section": "5.1 Diseño \\(2^{3-1}\\)",
    "text": "5.1 Diseño \\(2^{3-1}\\)\n\n\n\n\n\nFactoresCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IAp73.774.9027.5574.278.2430.0067.756.2720.4161.237.0613.67Bp72.874.6828.8473.076.3929.9666.855.7923.6060.834.3316.10Cp73.273.4727.0676.479.5926.6767.754.2919.4159.432.6514.90\n\n\n\nTabla 5.1: Concordancia porcentual en la significancia de los efectos según réplicas y puntos centrales en el diseño factorial 2³⁻¹\n\n\n\n\n\n\n\n\n\n\n\n\nFigura 5.1",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales $2^{k-p}$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#diseño-24-1-1",
    "href": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#diseño-24-1-1",
    "title": "2  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales \\(2^{k-p}\\)",
    "section": "5.2 Diseño \\(2^{4-1}\\)",
    "text": "5.2 Diseño \\(2^{4-1}\\)\n\n\n\n\n\nFactoresCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IAp63.848.6018.5761.141.1515.7757.128.689.9452.415.464.75Bp64.449.6218.8061.942.1115.6059.031.029.1953.718.055.77Cp62.948.6020.6561.142.4317.4257.330.8412.2653.420.568.82Dp61.446.9621.4458.738.8617.7256.430.3912.6953.920.266.13\n\n\n\nTabla 5.2: Concordancia porcentual en la significancia de los efectos según réplicas y puntos centrales en el diseño factorial 2⁴⁻¹\n\n\n\n\n\n\n\n\n\n\n\n\nFigura 5.2",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales $2^{k-p}$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#diseño-25",
    "href": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#diseño-25",
    "title": "2  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales \\(2^{k-p}\\)",
    "section": "5.3 Diseño \\(2^5\\)",
    "text": "5.3 Diseño \\(2^5\\)\n\n\n\n\n\nFactoresCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas con 5 puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesCon réplicas sin puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 5 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesSin réplicas con 2 puntos centralesConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IConcordanciaPotenciaError Tipo IAp62.639.2612.9162.435.949.8456.920.705.1254.515.044.10Bp59.637.3516.8758.132.4914.8154.417.126.1752.612.845.35Cp59.737.1215.0459.434.6612.9253.418.187.2051.913.074.66Dp62.939.2314.1761.934.5511.6156.216.465.3154.311.183.94Ep61.640.0815.1860.335.6513.1054.718.506.2452.713.294.78\n\n\n\nTabla 5.3: Concordancia porcentual en la significancia de los efectos según réplicas y puntos centrales en el diseño factorial 2⁵⁻²\n\n\n\n\n\n\n\n\n\n\n\n\nFigura 5.3",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales $2^{k-p}$</span>"
    ]
  },
  {
    "objectID": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#evaluación-del-ecm-por-medidas-repetidas-para-todos-los-tratamientos",
    "href": "01_dis_factoriales/compilado_factoriales_fraccionales_vfinal.html#evaluación-del-ecm-por-medidas-repetidas-para-todos-los-tratamientos",
    "title": "2  Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales \\(2^{k-p}\\)",
    "section": "5.4 Evaluación del ECM por medidas repetidas para todos los tratamientos",
    "text": "5.4 Evaluación del ECM por medidas repetidas para todos los tratamientos\n\n5.4.1 Análisis descriptivo de los ECM por diseño\n\n\n\n\n\n\n\n\nFigura 5.4: Análisis descriptivo de los ECM por diseño factorial fraccional\n\n\n\n\n\n\n\n5.4.2 Matriz de contrastes generales \\(C_1\\)\n\n\n\n\n\nDiseñoT²F_calculadoF_críticoDecisiónDiseño factorial 2³⁻¹290.7096.712.61Se rechaza H₀Diseño factorial 2⁴⁻¹915.61304.592.61Se rechaza H₀Diseño factorial 2⁵⁻²1,782.32592.922.61Se rechaza H₀\n\n\n\nTabla 5.4\n\n\n\n\n\n\n5.4.3 Matriz de contrastes generales de interés \\(C_2\\)\n\n\n\n\n\nDiseñoT²F_calculadoF_críticoDecisiónDiseño factorial 2³⁻¹2,907.79967.322.61Se rechaza H₀Diseño factorial 2⁴⁻¹1,710.10568.892.61Se rechaza H₀Diseño factorial 2⁵⁻²2,279.13758.192.61Se rechaza H₀\n\n\n\nTabla 5.5\n\n\n\n\nDado que, al evaluar la matriz de contrastes, se rechazó la hipótesis nula, es decir, al menos hay uno de los contrastes que es diferente de 0, resulta necesario analizar cada contraste de manera individual, obteniéndose los siguientes resultados:\n\n5.4.3.1 Contraste \\(C_{21} =\\) (-1, -1, 1, 1)\n\n\n\n\n\nDiseñoT²F_calculadoF_críticoDecisiónDiseño factorial 2³⁻¹216.4272.002.61Se rechaza H₀Diseño factorial 2⁴⁻¹436.77145.302.61Se rechaza H₀Diseño factorial 2⁵⁻²1,167.86388.512.61Se rechaza H₀\n\n\n\nTabla 5.6\n\n\n\n\n\n\n5.4.3.2 Contraste \\(C_{22} =\\) (-1, 1, 1, 1)\n\n\n\n\n\nDiseñoT²F_calculadoF_críticoDecisiónDiseño factorial 2³⁻¹1,118.55372.102.61Se rechaza H₀Diseño factorial 2⁴⁻¹1,086.94361.592.61Se rechaza H₀Diseño factorial 2⁵⁻²1,902.22632.802.61Se rechaza H₀\n\n\n\nTabla 5.7\n\n\n\n\n\n\n5.4.3.3 Contraste \\(C_{23} =\\) (1, -1, 0, 0)\n\n\n\n\n\nDiseñoT²F_calculadoF_críticoDecisiónDiseño factorial 2³⁻¹283.4894.302.61Se rechaza H₀Diseño factorial 2⁴⁻¹811.11269.832.61Se rechaza H₀Diseño factorial 2⁵⁻²1,758.73585.072.61Se rechaza H₀\n\n\n\nTabla 5.8\n\n\n\n\n\n\n\n\nDı́az Monroy, Luis Guillermo, y Rivera Morales Mario Alfonso. 2012. Análisis estadı́stico de datos multivariados. Universidad Nacional de Colombia.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Impacto de la eliminación de réplicas y puntos centrales en diseños factoriales fraccionales $2^{k-p}$</span>"
    ]
  }
]